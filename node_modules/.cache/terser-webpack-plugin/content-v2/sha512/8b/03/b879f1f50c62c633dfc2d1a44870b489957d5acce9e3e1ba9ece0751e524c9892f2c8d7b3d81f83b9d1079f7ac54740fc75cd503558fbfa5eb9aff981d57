{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[308],{815:function(_,v,n){\"use strict\";n.r(v);var r=n(42),t=Object(r.a)({},(function(){var _=this,v=_.$createElement,n=_._self._c||v;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":_.$parent.slotKey}},[n(\"h1\",{attrs:{id:\"hrra-007a-社会保険加入アラート通知-xaml\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#hrra-007a-社会保険加入アラート通知-xaml\"}},[_._v(\"#\")]),_._v(\" HRRA_007a_社会保険加入アラート通知.xaml\")]),_._v(\" \"),n(\"p\",[_._v(\"全体の処理フロー構成ファイル（ロボットが実行されるファイル）\")]),_._v(\" \"),n(\"h2\",{attrs:{id:\"引数\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#引数\"}},[_._v(\"#\")]),_._v(\" 引数\")]),_._v(\" \"),n(\"table\",[n(\"thead\",[n(\"tr\",[n(\"th\",[_._v(\"引数名\")]),_._v(\" \"),n(\"th\",[_._v(\"説明\")]),_._v(\" \"),n(\"th\",[_._v(\"方向\")]),_._v(\" \"),n(\"th\",[_._v(\"型\")]),_._v(\" \"),n(\"th\",[_._v(\"備考\")])])]),_._v(\" \"),n(\"tbody\",[n(\"tr\",[n(\"td\",[_._v(\"in_commonSettingsPath\")]),_._v(\" \"),n(\"td\",[_._v(\"共通設定ファイルパス\")]),_._v(\" \"),n(\"td\",[_._v(\"入力\")]),_._v(\" \"),n(\"td\",[_._v(\"String\")]),_._v(\" \"),n(\"td\",[_._v('既定値：\"c:\\\\diprpa\\\\共通\\\\HR_共通設定.xlsx\"')])]),_._v(\" \"),n(\"tr\",[n(\"td\",[_._v(\"in_projectName\")]),_._v(\" \"),n(\"td\",[_._v(\"プロジェクト名\")]),_._v(\" \"),n(\"td\",[_._v(\"入力\")]),_._v(\" \"),n(\"td\",[_._v(\"String\")]),_._v(\" \"),n(\"td\",[_._v('既定値：\"HRRA_007a_社会保険加入アラート通知\"')])])])]),_._v(\" \"),n(\"br\"),_._v(\" \"),n(\"h2\",{attrs:{id:\"処理内容\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#処理内容\"}},[_._v(\"#\")]),_._v(\" 処理内容\")]),_._v(\" \"),n(\"ol\",[n(\"li\",[n(\"p\",[_._v(\"初期処理\"),n(\"br\"),_._v(\"\\n1-1. プロジェクト名の設定\"),n(\"br\"),_._v(\"\\n1-2. 処理日（処理開始時間）の取得\"),n(\"br\"),_._v(\"\\n1-3. 共通設定のファイル存在確認・読込\"),n(\"br\"),_._v(\"\\n1-4. システムルートフォルダ存在確認\"),n(\"br\"),_._v(\"\\n1-5. プロジェクト専用フォルダ存在確認\"),n(\"br\"),_._v(\"\\n1-6. ユーザー設定のファイル存在確認・読込\"),n(\"br\"),_._v(\"\\n1-7. プロジェクト設定のファイル存在確認・読込\"),n(\"br\"),_._v(\"\\n1-8. 初期処理の結果確認\"),n(\"br\"),_._v(\"\\n　初期処理でエラーが発生した場合、例外（Exception）で処理を終了する\")])]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"必須情報の有無\"),n(\"br\"),_._v(\"\\n2-1. 共通設定情報取得\"),n(\"br\"),_._v(\"\\n　2-1-1. メールシステムを取得する\"),n(\"br\"),_._v(\"\\n　　メールシステム\"),n(\"br\"),_._v(\"\\n　　上記1-2の共通設定「UseMailSystem」\"),n(\"br\"),_._v(\"\\n　2-1-2. 上記2-1-1のメールシステムに該当する設定内容を上記1-2の共通設定から確認する\"),n(\"br\"),_._v(\"\\n　　共通モジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/common_workflow/設定文字列確認.html\"}},[n(\"strong\",[_._v(\"設定文字列確認.xaml\")])]),_._v(\"」使用\"),n(\"br\"),_._v(\"\\n　　メールシステムが「1」（Gmail）の場合は以下の項目を確認する\"),n(\"br\"),_._v(\"\\n　　　・GmailClientID\"),n(\"br\"),_._v(\"\\n　　　・GmailClientSecret\"),n(\"br\"),_._v(\"\\n　　メールシステムが「2」（Outlook）の場合は以下の項目を確認する\"),n(\"br\"),_._v(\"\\n　　　・OutlookMailAccount\"),n(\"br\"),_._v(\"\\n　　メールシステムが「3」（SMTP）の場合は以下の項目を確認する\"),n(\"br\"),_._v(\"\\n　　　・SmtpServer\"),n(\"br\"),_._v(\"\\n　　　・SmtpPort\"),n(\"br\"),_._v(\"\\n　　　・SmtpMailAccount\"),n(\"br\"),_._v(\"\\n　　　・SmtpPassword\"),n(\"br\"),_._v(\"\\n　　メールシステムが「4」（Exchange）の場合は以下の項目を確認する\"),n(\"br\"),_._v(\"\\n　　　・ExchangeUser\"),n(\"br\"),_._v(\"\\n　　　・ExchangePassword\"),n(\"br\"),_._v(\"\\n　　　・ExchangeServer\"),n(\"br\"),_._v(\"\\n　2-1-3. 上記2-1-2で取得できない項目が存在した場合はエラー\")],1),_._v(\" \"),n(\"p\",[_._v(\"2-2. プロジェクト設定情報取得\")]),_._v(\" \"),n(\"p\",[_._v(\"2-3. ユーザー設定情報取得\")]),_._v(\" \"),n(\"p\",[_._v(\"2-4. HR企業担当者メールアドレス情報の取得\"),n(\"br\"),_._v(\"\\n　2-4-1. Toアドレスを上記1-5のユーザー設定「MailAddressTo」から取得する\"),n(\"br\"),_._v(\"\\n　　値がない場合、上記1-2の共通設定「UseMailSystem」から取得する\"),n(\"br\"),_._v(\"\\n　　値がない場合、または、取得したメールアドレスに不正文字が含まれている場合はエラー\"),n(\"br\"),_._v(\"\\n　2-4-2. Ccアドレスを上記1-5のユーザー設定「MailAddressCc」から取得する\"),n(\"br\"),_._v(\"\\n　　値がない場合、上記1-2の共通設定「UserAddressCc」から取得する\"),n(\"br\"),_._v(\"\\n　　取得したメールアドレスに不正文字が含まれている場合はエラー\"),n(\"br\"),_._v(\"\\n　2-4-3. Bccアドレスを上記1-5のユーザー設定「MailAddressBcc」から取得する\"),n(\"br\"),_._v(\"\\n　　値がない場合、上記1-2の共通設定「UserAddressBcc」から取得する\"),n(\"br\"),_._v(\"\\n　　取得したメールアドレスに不正文字が含まれている場合はエラー\")]),_._v(\" \"),n(\"p\",[_._v(\"2-5. フォルダの存在確認・作成\"),n(\"br\"),_._v(\"\\n　2-5-1. tmpフォルダが存在しない場合は作成する\"),n(\"br\"),_._v(\"\\n　　tmpフォルダパス\"),n(\"br\"),_._v('\\n　　　上記1-5のプロジェクトフォルダ＋\"￥\"＋上記1-6のプロジェクト設定「TmpFolder」'),n(\"br\"),_._v(\"\\n　2-5-2. exportフォルダが存在しない場合は作成する\"),n(\"br\"),_._v(\"\\n　　exportフォルダパス\"),n(\"br\"),_._v('\\n　　　上記1-5のプロジェクトフォルダ＋\"￥\"＋上記1-6のプロジェクト設定「ExportFolder」'),n(\"br\"),_._v(\"\\n　2-5-3. アラート通知フォルダが存在しない場合は作成する\"),n(\"br\"),_._v(\"\\n　　アラート通知フォルダパス\"),n(\"br\"),_._v('\\n　　　上記1-5のプロジェクトフォルダ＋\"￥\"＋上記1-5のユーザー設定「OutputFilePath」'),n(\"br\"),_._v(\"\\n　2-5-4. Sendフォルダが存在しない場合は作成する\"),n(\"br\"),_._v(\"\\n　　Sendフォルダパス\"),n(\"br\"),_._v('\\n　　　上記1-5のプロジェクトフォルダ＋\"￥\"＋上記1-6のプロジェクト設定「SendFolder」'),n(\"br\"),_._v(\"\\n　2-5-5. Sentフォルダが存在しない場合は作成する\"),n(\"br\"),_._v(\"\\n　　Sentフォルダパス\"),n(\"br\"),_._v('\\n　　　上記1-5のプロジェクトフォルダ＋\"￥\"＋上記1-6のプロジェクト設定「SentFolder」')]),_._v(\" \"),n(\"p\",[_._v(\"2-6. ファイルの存在確認\"),n(\"br\"),_._v(\"\\n　2-6-1. templateファイル①を確認する\"),n(\"br\"),_._v(\"\\n　　templateファイル①パスの取得\"),n(\"br\"),_._v('\\n　　　上記1-5のプロジェクトフォルダ＋\"￥\"＋上記1-5のユーザー設定「TemplateMailFile」'),n(\"br\"),_._v(\"\\n　　ファイルが存在しない場合はエラー\"),n(\"br\"),_._v(\"\\n　2-6-2. templateファイル②を確認する\"),n(\"br\"),_._v(\"\\n　　templateファイル②パスの取得\"),n(\"br\"),_._v('\\n　　　上記1-5のプロジェクトフォルダ＋\"￥\"＋上記1-5のユーザー設定「TemplateNonDataMailFile」'),n(\"br\"),_._v(\"\\n　　ファイルが存在しない場合はエラー\")]),_._v(\" \"),n(\"p\",[_._v(\"2-7. 必須情報有無の結果確認\"),n(\"br\"),_._v(\"\\n　必須情報の有無でエラーが発生した場合、例外（Exception）で処理を終了する\")])]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"過去ファイルの削除\"),n(\"br\"),_._v(\"\\n3-1. 上記2-5-1のtmpフォルダ内ファイルをすべて削除する\")]),_._v(\" \"),n(\"p\",[_._v(\"3-2. 上記2-5-5のSentフォルダ内ファイルをすべて削除する\")]),_._v(\" \"),n(\"p\",[_._v(\"3-3. 上記2-5-4のSendフォルダ内ファイルをすべて削除する\")]),_._v(\" \"),n(\"p\",[_._v(\"3-4. 上記2-5-2のexportフォルダ内ファイルをすべて削除する\")]),_._v(\" \"),n(\"p\",[_._v(\"3-5. アラート通知フォルダ内のファイルを削除する\"),n(\"br\"),_._v(\"\\n　サブモジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/社会保険加入アラート通知/詳細機能設計/WF_HRRA_007a_社会保険加入アラート通知/xaml/DeleteOutputFile.html\"}},[n(\"strong\",[_._v(\"DeleteOutputFile.xaml\")])]),_._v(\"」使用\"),n(\"br\"),_._v(\"\\n　　引数\"),n(\"br\"),_._v(\"\\n　　　・in_outputFolderPath ← 上記2-5-3のアラート通知フォルダパス\"),n(\"br\"),_._v(\"\\n　　　・in_fileDeleteInitial ← プロジェクト名（引数：in_projectName）\"),n(\"br\"),_._v(\"\\n　　　・in_nowDate ← 上記1-2の処理日\"),n(\"br\"),_._v(\"\\n　　　・in_fileDeleteCycle ← 上記1-5のユーザー設定「FileDeleteCycle」\")],1),_._v(\" \"),n(\"p\",[_._v(\"3-6. 過去ファイル削除の結果確認\"),n(\"br\"),_._v(\"\\n　過去ファイル削除でエラーが発生した場合、例外（Exception）で処理を終了する\")])]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"基幹システム操作\"),n(\"br\"),_._v(\"\\n4-1. StaffNavigatorの起動\"),n(\"br\"),_._v(\"\\n　4-1-1. StaffNavigatorの起動\"),n(\"br\"),_._v(\"\\n　　共通モジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/login_workflow/StaffNaviLogin.html\"}},[n(\"strong\",[_._v(\"StaffNaviLogin.xaml\")])]),_._v(\"」使用\"),n(\"br\"),_._v(\"\\n　　　引数\"),n(\"br\"),_._v(\"\\n　　　　・in_dicUserSettings ← 上記1-5のユーザー設定\"),n(\"br\"),_._v(\"\\n　　　　・in_dicCommonSettings ← 上記1-2の共通設定\"),n(\"br\"),_._v(\"\\n　4-1-2. 起動が失敗した場合、上記4-1-1をリトライする\"),n(\"br\"),_._v(\"\\n　　リトライ回数：3回\"),n(\"br\"),_._v(\"\\n　　リトライ間隔：5秒\")],1),_._v(\" \"),n(\"p\",[_._v(\"4-2. 社会保険スタッフ情報ファイルの出力\"),n(\"br\"),_._v(\"\\n　4-2-1. ファイルパスの取得\"),n(\"br\"),_._v('\\n　　上記2-5-2のexportフォルダパス＋\"￥ExportStaffList.csv\"'),n(\"br\"),_._v(\"\\n　4-2-2. ファイルの出力\"),n(\"br\"),_._v(\"\\n　　サブモジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/社会保険加入アラート通知/詳細機能設計/WF_HRRA_007a_社会保険加入アラート通知/xaml/StaffNaviCSVExport.html\"}},[n(\"strong\",[_._v(\"StaffNaviCSVExport.xaml\")])]),_._v(\"」使用\"),n(\"br\"),_._v(\"\\n　　　引数\"),n(\"br\"),_._v(\"\\n　　　　・in_dicUserSettings ← 上記1-5のユーザー設定\"),n(\"br\"),_._v(\"\\n　　　　・in_staffCsvFile ← 上記4-2-1のファイルパス\"),n(\"br\"),_._v(\"\\n　4-2-3. ファイルの確認\"),n(\"br\"),_._v(\"\\n　　ファイルが存在しない場合、下記6の処理へ移動する\")],1),_._v(\" \"),n(\"p\",[_._v(\"4-3. 賃金台帳ファイルの出力\"),n(\"br\"),_._v(\"\\n　4-3-1. ファイルパスの取得\"),n(\"br\"),_._v('\\n　　上記2-5-2のexportフォルダパス＋\"￥ExportAttendance.csv\"'),n(\"br\"),_._v(\"\\n　4-3-2. ファイルの出力\"),n(\"br\"),_._v(\"\\n　　サブモジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/社会保険加入アラート通知/詳細機能設計/WF_HRRA_007a_社会保険加入アラート通知/xaml/AttendanceCSVExport.html\"}},[n(\"strong\",[_._v(\"AttendanceCSVExport.xaml\")])]),_._v(\"」使用\"),n(\"br\"),_._v(\"\\n　　　引数\"),n(\"br\"),_._v(\"\\n　　　　・in_dicUserSettings ← 上記1-5のユーザー設定\"),n(\"br\"),_._v(\"\\n　　　　・in_attendanceFileCsv ← 上記4-3-1のファイルパス\"),n(\"br\"),_._v(\"\\n　　　　・in_currentDateTime ← 上記1-2の処理日\"),n(\"br\"),_._v(\"\\n　4-3-3. ファイルの確認\"),n(\"br\"),_._v(\"\\n　　ファイルが存在しない場合、下記6の処理へ移動する\")],1),_._v(\" \"),n(\"p\",[_._v(\"4-4. 基幹システム操作の結果確認\"),n(\"br\"),_._v(\"\\n　基幹システム操作でエラーが発生した場合、例外（Exception）で処理を終了する\")])]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"社会保険加入アラートファイルの作成\"),n(\"br\"),_._v(\"\\n5-1. ファイルパスの取得\"),n(\"br\"),_._v('\\n　上記2-5-3のアラート通知フォルダパス＋\"￥\"＋'),n(\"br\"),_._v('\\n　プロジェクト名（引数：in_projectName）＋\"_\"＋上記1-2の処理日yyyyMMdd_HHmmss形式＋\".csv\"')]),_._v(\" \"),n(\"p\",[_._v(\"5-2. ファイルの作成\"),n(\"br\"),_._v(\"\\n　サブモジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/社会保険加入アラート通知/詳細機能設計/WF_HRRA_007a_社会保険加入アラート通知/xaml/ResultCSV.html\"}},[n(\"strong\",[_._v(\"ResultCSV.xaml\")])]),_._v(\"」使用\"),n(\"br\"),_._v(\"\\n　　引数\"),n(\"br\"),_._v(\"\\n　　　・in_staffCSVPath ← 上記4-2-1の社会保険スタッフ情報ファイルパス\"),n(\"br\"),_._v(\"\\n　　　・in_wareCSVPath ← 上記4-3-1の賃金台帳ファイルパス\"),n(\"br\"),_._v(\"\\n　　　・in_tmpPath ← 上記2-5-1のtmpフォルダパス\"),n(\"br\"),_._v(\"\\n　　　・in_monthX ← 上記1-2の処理日の前々月（処理日「20020/10/10」の場合、「8」）\"),n(\"br\"),_._v(\"\\n　　　・in_monthY ← 上記1-2の処理日の前月（処理日「20020/10/10」の場合、「9」）\"),n(\"br\"),_._v(\"\\n　　　・in_workingLimit ← 上記1-5のユーザー設定「WorkingTimeLimit」\"),n(\"br\"),_._v(\"\\n　　　・in_resultCSVPath ← 上記5-1のファイルパス\"),n(\"br\"),_._v(\"\\n　　　・in_currentDatetime ← 上記1-2の処理日\")],1)]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"社会保険加入アラート通知のメール送信\"),n(\"br\"),_._v(\"\\n6-1. 社会保険加入アラート通知メールCSVファイルの作成\"),n(\"br\"),_._v(\"\\n　6-1-1. ファイルパスの取得\"),n(\"br\"),_._v('\\n　　上記2-5-4のSendフォルダパス＋\"￥\"'),n(\"br\"),_._v('\\n　　＋\"Mail_Insurance_\"＋上記1-2の処理日yyyyMMdd形式＋\".csv\"'),n(\"br\"),_._v(\"\\n　6-1-2. 社会保険加入アラートファイルが存在する場合\"),n(\"br\"),_._v(\"\\n　　テンプレート：上記2-6-1のtemplateファイル①パス\"),n(\"br\"),_._v(\"\\n　　社会保険加入アラート通知メールCSVファイル（データあり）の作成内容\"),n(\"br\"),_._v(\"\\n　　　・send_to ← 上記2-4-1ののToアドレス を配置\"),n(\"br\"),_._v(\"\\n　　　・cc ← 上記2-4-2ののCcアドレス を配置\"),n(\"br\"),_._v(\"\\n　　　・bcc ← 上記2-4-3ののBccアドレス を配置\"),n(\"br\"),_._v(\"\\n　　　・body内の「＜社会保険加入アラートファイルパス＞」← 上記5-1のファイルパス を置換\"),n(\"br\"),_._v(\"\\n　6-1-3. 社会保険加入アラートファイルが存在しない場合\"),n(\"br\"),_._v(\"\\n　　テンプレート：上記2-6-2のtemplateファイル②パス\"),n(\"br\"),_._v(\"\\n　　社会保険加入アラート通知メールCSVファイル（データなし）の作成内容\"),n(\"br\"),_._v(\"\\n　　　・send_to ← 上記2-4-1ののToアドレス を配置\"),n(\"br\"),_._v(\"\\n　　　・cc ← 上記2-4-2ののCcアドレス を配置\"),n(\"br\"),_._v(\"\\n　　　・bcc ← 上記2-4-3ののBccアドレス を配置\")]),_._v(\" \"),n(\"p\",[_._v(\"6-2. メール送信\"),n(\"br\"),_._v(\"\\n　　　共通モジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/mail_workflow/BulkMailSend.html\"}},[n(\"strong\",[_._v(\"BulkMailSend.xaml\")])]),_._v(\"」使用\"),n(\"br\"),_._v(\"\\n　引数\"),n(\"br\"),_._v(\"\\n　　・in_dicMailConfig ← 上記1-2の共通設定\"),n(\"br\"),_._v(\"\\n　　・in_sendFolderPath ← 上記2-5-4のSendフォルダパス\"),n(\"br\"),_._v(\"\\n　　・in_sendedFolderPath  ← 上記2-5-5のSentフォルダパス\")],1),_._v(\" \"),n(\"p\",[_._v(\"6-3. 社会保険加入アラート通知メール送信の結果確認\"),n(\"br\"),_._v(\"\\n　社会保険加入アラート通知メール送信でエラーが発生した場合、例外（Exception）で処理を終了する\")])]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"処理済ファイルの削除\"),n(\"br\"),_._v(\"\\n7-1. 上記2-5-1のtmpフォルダ内ファイルをすべて削除する\")]),_._v(\" \"),n(\"p\",[_._v(\"7-2. 上記2-5-5のSentフォルダ内ファイルをすべて削除する\")]),_._v(\" \"),n(\"p\",[_._v(\"7-3. 上記2-5-4のSendフォルダ内ファイルをすべて削除する\")]),_._v(\" \"),n(\"p\",[_._v(\"7-4. 上記2-5-2のexportフォルダ内ファイルをすべて削除する\")])]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"終端処理\")])])]),_._v(\" \"),n(\"br\")])}),[],!1,null,null,null);v.default=t.exports}}]);","extractedComments":[]}