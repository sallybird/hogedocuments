{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[341],{857:function(_,r,n){\"use strict\";n.r(r);var v=n(42),t=Object(v.a)({},(function(){var _=this,r=_.$createElement,n=_._self._c||r;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":_.$parent.slotKey}},[n(\"h1\",{attrs:{id:\"hrra-001a-スタッフ出力-xaml\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#hrra-001a-スタッフ出力-xaml\"}},[_._v(\"#\")]),_._v(\" HRRA_001a_スタッフ出力.xaml\")]),_._v(\" \"),n(\"p\",[_._v(\"基幹システム(Staff Navigator)からスタッフ情報を出力し、ノリスケに送付する\")]),_._v(\" \"),n(\"h2\",{attrs:{id:\"引数\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#引数\"}},[_._v(\"#\")]),_._v(\" 引数\")]),_._v(\" \"),n(\"table\",[n(\"thead\",[n(\"tr\",[n(\"th\",[_._v(\"引数名\")]),_._v(\" \"),n(\"th\",[_._v(\"説明\")]),_._v(\" \"),n(\"th\",[_._v(\"方向\")]),_._v(\" \"),n(\"th\",[_._v(\"型\")]),_._v(\" \"),n(\"th\",[_._v(\"備考\")])])]),_._v(\" \"),n(\"tbody\",[n(\"tr\",[n(\"td\",[_._v(\"in_commonSettingsPath\")]),_._v(\" \"),n(\"td\",[_._v(\"ファイルパス\")]),_._v(\" \"),n(\"td\",[_._v(\"入力\")]),_._v(\" \"),n(\"td\",[_._v(\"String\")]),_._v(\" \"),n(\"td\",[_._v('既定値：\"d:\\\\diprpa\\\\共通\\\\HR_共通設定.xlsx\"')])]),_._v(\" \"),n(\"tr\",[n(\"td\",[_._v(\"in_projectName\")]),_._v(\" \"),n(\"td\",[_._v(\"プロジェクト名\")]),_._v(\" \"),n(\"td\",[_._v(\"入力\")]),_._v(\" \"),n(\"td\",[_._v(\"String\")]),_._v(\" \"),n(\"td\",[_._v('既定値：\"HRRA_001a_スタッフ出力\"')])])])]),_._v(\" \"),n(\"br\"),_._v(\" \"),n(\"h2\",{attrs:{id:\"処理内容\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#処理内容\"}},[_._v(\"#\")]),_._v(\" 処理内容\")]),_._v(\" \"),n(\"ol\",[n(\"li\",[n(\"p\",[_._v(\"初期処理\"),n(\"br\"),_._v(\"\\n1-1. プロジェクト名の設定\"),n(\"br\"),_._v(\"\\n1-2. Excel全クローズ\"),n(\"br\"),_._v(\"\\n1-3. 共通設定の読み込み\"),n(\"br\"),_._v(\"\\n1-4. ルートパスの存在確認\"),n(\"br\"),_._v(\"\\n1-5. プロジェクトフォルダ・ファイルのチェック\"),n(\"br\"),_._v(\"\\n1-6. ユーザー設定の読み込み\"),n(\"br\"),_._v(\"\\n1-7. プロジェクト設定の読み込み\"),n(\"br\"),_._v(\"\\n1-8. 初期処理のエラー判定\"),n(\"br\"),_._v(\"\\n　・初期処理でエラーが発生した場合、例外をThrowする\")])]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"設定情報の確認\"),n(\"br\"),_._v(\"\\n2-1. ユーザー設定ファイルの読み込み、各項目値のチェックを行う\"),n(\"br\"),_._v(\"\\n　2-1-1. 「NULL値許可」が「NG」で、「Value」がNULLの場合、エラー\"),n(\"br\"),_._v(\"\\n　2-1-2. 「型」が「Int32」の場合、共通モジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/common_workflow/設定数値確認.html\"}},[n(\"strong\",[_._v(\"設定数値確認.xaml\")])]),_._v(\"」を呼び出し、「Value」の補正を行う\"),n(\"br\"),_._v(\"\\n　　引数：\"),n(\"br\"),_._v(\"\\n　　・in_defaultValue：「初期値」\"),n(\"br\"),_._v(\"\\n　　・in_minValue：「最小値」\"),n(\"br\"),_._v(\"\\n　　・in_maxValue：「最大値」\"),n(\"br\"),_._v(\"\\n　2-1-3. 「型」が「Boolean」、型変換を行いException発生時\"),n(\"br\"),_._v(\"\\n　　・「NULL許可値」が「NG」の場合、エラー\"),n(\"br\"),_._v(\"\\n　　・「NULL値許可」が「OK」の場合、「初期値」を取得値とする\"),n(\"br\"),_._v(\"\\n2-2. 設定ファイルの設定値チェック\"),n(\"br\"),_._v(\"\\n　2-2-1. Tmpフォルダパスの作成\"),n(\"br\"),_._v(\"\\n　　・共通モジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/common_workflow/設定文字列確認.html\"}},[n(\"strong\",[_._v(\"設定文字列確認.xaml\")])]),_._v(\"」を呼び出し、プロジェクト設定ファイルにTmpフォルダの設定が存在するか確認\"),n(\"br\"),_._v(\"\\n　　　引数：\"),n(\"br\"),_._v('\\n　　　・in_keyValue：\"TmpFolder\"'),n(\"br\"),_._v('\\n　　・プロジェクトルートパスとプロジェクト設定ファイル(\"TmpFolder\")を結合し、パスを作成する'),n(\"br\"),_._v(\"\\n　2-2-2. ノリスケ送付項目テンプレートファイルパスの作成\"),n(\"br\"),_._v(\"\\n　　・共通モジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/common_workflow/設定文字列確認.html\"}},[n(\"strong\",[_._v(\"設定文字列確認.xaml\")])]),_._v(\"」を呼び出し、プロジェクト設定ファイルにテンプレートファイルパスの設定が存在するか確認\"),n(\"br\"),_._v(\"\\n　　　引数：\"),n(\"br\"),_._v('\\n　　　・in_keyValue：\"ApiSetStaffTemplate\"'),n(\"br\"),_._v('\\n　　・プロジェクトルートパスとプロジェクト設定ファイル(\"ApiSetStaffTemplate\")を結合し、パスを作成する'),n(\"br\"),_._v(\"\\n　2-2-3. スタッフ情報フォルダパスの確認\"),n(\"br\"),_._v(\"\\n　　・共通モジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/common_workflow/設定文字列確認.html\"}},[n(\"strong\",[_._v(\"設定文字列確認.xaml\")])]),_._v(\"」を呼び出し、共通設定ファイルにスタッフ情報フォルダパスの設定が存在するか確認\"),n(\"br\"),_._v(\"\\n　　　引数：\"),n(\"br\"),_._v('\\n　　　・in_keyValue：\"StaffInformation\"'),n(\"br\"),_._v(\"\\n　　　・out_settingValue：スタッフ情報フォルダパス\"),n(\"br\"),_._v(\"\\n　2-2-4. スタッフ情報ファイルパスの確認\"),n(\"br\"),_._v(\"\\n　　・共通モジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/common_workflow/設定文字列確認.html\"}},[n(\"strong\",[_._v(\"設定文字列確認.xaml\")])]),_._v(\"」を呼び出し、共通設定ファイルにスタッフ情報ファイルパスの設定が存在するか確認\"),n(\"br\"),_._v(\"\\n　　　引数：\"),n(\"br\"),_._v('\\n　　　・in_keyValue：\"StaffInformationFile\"'),n(\"br\"),_._v(\"\\n　　　・out_settingValue：スタッフ情報ファイルパス\"),n(\"br\"),_._v(\"\\n2-3. 必要なフォルダの確認\"),n(\"br\"),_._v(\"\\n　2-3-1. Tmpフォルダの存在確認を行い、存在しない場合はフォルダを作成する\"),n(\"br\"),_._v(\"\\n　2-3-2. Tmpフォルダ内のファイルの存在確認を行い、存在する場合はTmpフォルダ内のファイルを削除する\"),n(\"br\"),_._v(\"\\n2-4. 必要なファイルの確認\"),n(\"br\"),_._v(\"\\n　2-4-1. スタッフ情報フォルダパスの存在確認を行い、存在しない場合はエラーとする\"),n(\"br\"),_._v(\"\\n　2-4-2. ノリスケ送付項目テンプレートファイルの存在確認を行い、存在しない場合はエラーとする\"),n(\"br\"),_._v(\"\\n2-5. 処理中にエラーがある場合、終端処理へ\")],1)]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"Staff Navigatorからスタッフ情報CSVファイルを出力\"),n(\"br\"),_._v(\"\\n3-1. ユーザー入力をブロック\"),n(\"br\"),_._v(\"\\n　・「Alt」+「F10」を入力する\"),n(\"br\"),_._v(\"\\n3-2. 共通モジュール「\"),n(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/login_workflow/StaffNaviLogin.html\"}},[n(\"strong\",[_._v(\"StaffNaviLogin.xaml\")])]),_._v(\"」を呼び出し、Staff Navigatorの起動、ログインを行う\"),n(\"br\"),_._v(\"\\n3-3. 「スタッフ情報CSVﾌｧｲﾙ出力」を選択する\"),n(\"br\"),_._v(\"\\n　3-3-1. メニュー「ｽﾀｯﾌ管理」を選択する\"),n(\"br\"),_._v(\"\\n　　・「Alt」+「S」を入力する\"),n(\"br\"),_._v(\"\\n　3-3-2. メニュー「CSVﾌｧｲﾙ出力」を選択する\"),n(\"br\"),_._v(\"\\n　　・「F」を入力する\"),n(\"br\"),_._v(\"\\n　3-3-3. メニュー「スタッフ情報CSVﾌｧｲﾙ出力」を選択する\"),n(\"br\"),_._v(\"\\n　　・「F」を入力する\"),n(\"br\"),_._v(\"\\n　　・「スタッフデータのCSVファイル出力」画面が表示される\"),n(\"br\"),_._v(\"\\n　3-3-4. メニュー「スタッフ情報CSVﾌｧｲﾙ出力」に辿り着かない、選択出来ない場合、権限が足りない為エラーとする\"),n(\"br\"),_._v(\"\\n　　・プロセス「StaffNavigator」を終了する\"),n(\"br\"),_._v(\"\\n3-4. スタッフ情報CSVファイルを出力\"),n(\"br\"),_._v(\"\\n　3-4-1. 出力内容「出力レイアウトから選択する」を選択する\"),n(\"br\"),_._v(\"\\n　3-4-2. 出力レイアウトの選択\"),n(\"br\"),_._v('\\n　　・ユーザー設定ファイル(\"LayoutName\")からレイアウト名を取得'),n(\"br\"),_._v(\"\\n　　・取得したレイアウト名と一致する出力レイアウトを選択する\"),n(\"br\"),_._v(\"\\n　3-4-3.「Ok」ボタンをクリックする\"),n(\"br\"),_._v(\"\\n3-5. スタッフ情報CSVファイルの保存\"),n(\"br\"),_._v(\"\\n　3-5-1. ファイルの保存先\"),n(\"br\"),_._v(\"\\n　　・パス：[2-2-1]で作成したTmpフォルダ\"),n(\"br\"),_._v('\\n　　・ファイル名：StaffNavi_処理日付(\"yyyyMMdd\").csv'),n(\"br\"),_._v(\"\\n　3-5-2. 保存先を入力し、「保存」ボタンをクリックする\"),n(\"br\"),_._v(\"\\n　3-5-3. 出力終了メッセージ画面の「OK」ボタンをクリックする\"),n(\"br\"),_._v(\"\\n　3-5-4. Exception発生時\"),n(\"br\"),_._v(\"\\n　　・処理をエラーとする\"),n(\"br\"),_._v(\"\\n　　・プロセス「StaffNavigator」を終了する\"),n(\"br\"),_._v(\"\\n3-6. Staff Navigatorの終了処理\"),n(\"br\"),_._v(\"\\n　・スタッフ情報CSVファイルの出力処理が正常に終了した場合\"),n(\"br\"),_._v(\"\\n　　→ プロセス「StaffNavigator」を終了する\"),n(\"br\"),_._v(\"\\n3-7. 出力したスタッフ情報CSVファイルの移動\"),n(\"br\"),_._v(\"\\n　3-7-1. [3-5]で出力したスタッフ情報CSVファイルの存在確認を行う\"),n(\"br\"),_._v(\"\\n　　・存在しない場合、エラーとする\"),n(\"br\"),_._v(\"\\n　3-7-2. [2-2-4]のスタッフ情報ファイルの存在確認を行う\"),n(\"br\"),_._v(\"\\n　　・存在する場合、[3-5]で出力したスタッフ情報CSVファイルを[2-2-4]のパスに上書きコピーする\"),n(\"br\"),_._v(\"\\n　　・存在しない場合、[3-5]で出力したスタッフ情報CSVファイルを[2-2-4]のパスにコピーする\"),n(\"br\"),_._v(\"\\n3-8. 処理中にエラーがある場合、終端処理へ\")],1)]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"ノリスケ送信用ファイルのAPI送信\"),n(\"br\"),_._v('\\n4-1. ノリスケ連携フラグをユーザー設定ファイル(\"ApiLinking\")から取得'),n(\"br\"),_._v(\"\\n　・Falseの場合、ノリスケ連携を行わない\"),n(\"br\"),_._v(\"\\n4-2. [3-7]のスタッフ情報CSVファイルの存在確認を行う\"),n(\"br\"),_._v(\"\\n　・存在しない場合、エラーとし、ノリスケ連携を行わない\"),n(\"br\"),_._v(\"\\n4-3. ノリスケ送信用ファイルの作成\"),n(\"br\"),_._v(\"\\n　4-3-1. [3-5]で出力したスタッフ情報CSVファイルを読み込む\"),n(\"br\"),_._v(\"\\n　4-3-2. ノリスケ送付項目テンプレートファイルを読み込む\"),n(\"br\"),_._v(\"\\n　　→パス：[2-2-2]で作成したノリスケ送付項目テンプレートファイルパス\"),n(\"br\"),_._v(\"\\n　4-3-3. 読み込んだスタッフ情報CSVファイルの値をノリスケ送付項目に対応する項目に値をセットし、ノリスケ送信用データを作成する\"),n(\"br\"),_._v(\"\\n　　※ office_nameはユーザー設定ファイルの値をセットする\"),n(\"br\"),_._v(\"\\n　　[\"),n(\"strong\",[_._v(\"ノリスケ項目\")]),_._v(\"] ← [\"),n(\"strong\",[_._v(\"スタッフ情報CSV項目\")]),_._v(\"]\"),n(\"br\"),_._v(\"\\n　　name ← 氏名(漢字)\"),n(\"br\"),_._v(\"\\n　　kana ← 氏名(ｶﾅ)\"),n(\"br\"),_._v(\"\\n　　gender ← 性別\"),n(\"br\"),_._v(\"\\n　　birthday ← 生年月日\"),n(\"br\"),_._v(\"\\n　　email1 ← ﾒｰﾙｱﾄﾞﾚｽ\"),n(\"br\"),_._v(\"\\n　　tel1 ← 電話番号\"),n(\"br\"),_._v(\"\\n　　tel2 ← 携帯番号\"),n(\"br\"),_._v(\"\\n　　postcode ← 郵便番号\"),n(\"br\"),_._v(\"\\n　　prefecture ← 住所1\"),n(\"br\"),_._v(\"\\n　　address ← 住所2\"),n(\"br\"),_._v(\"\\n　　address_remarks ← 住所3\"),n(\"br\"),_._v('\\n　　office_name ← ユーザー設定ファイル(\"OfficeName\")'),n(\"br\"),_._v(\"\\n　4-3-4. 作成したノリスケ送信用データをファイル出力する\"),n(\"br\"),_._v(\"\\n　　パス：[2-2-1]で作成したTmpフォルダ\"),n(\"br\"),_._v(\"\\n　　ファイル名：SetStaffList.csv\"),n(\"br\"),_._v(\"\\n　4-3-5. [4-3-4]で出力したノリスケ送信ファイルの存在確認を行う\"),n(\"br\"),_._v(\"\\n　　・存在しない場合、エラーとする\"),n(\"br\"),_._v(\"\\n4-4. API送信用の設定値を取得\"),n(\"br\"),_._v(\"\\n　4-4-1. ノリスケ送信時の待機アクティビティで待機する秒数\"),n(\"br\"),_._v('\\n　　・ユーザー設定ファイル(\"DelayTime_API\")を数値変換'),n(\"br\"),_._v(\"\\n　　・数値変換した値 * 1000\"),n(\"br\"),_._v(\"\\n　4-4-2. APIでスタッフ情報送付に失敗した場合、再度処理を実行するまでの待機時間\"),n(\"br\"),_._v('\\n　　・ユーザー設定ファイル(\"ApiRetryTime\")を数値変換'),n(\"br\"),_._v(\"\\n　　・数値変換した値 * 1000\"),n(\"br\"),_._v(\"\\n　4-4-3. APIでスタッフ情報送付に失敗した場合、再度処理を実行する回数\"),n(\"br\"),_._v('\\n　　・ユーザー設定ファイル(\"ApiRetryCount\")を数値変換'),n(\"br\"),_._v(\"\\n　4-4-4. APIでスタッフ情報を送付する際に利用するURL\"),n(\"br\"),_._v('\\n　　・ユーザー設定ファイル(\"ApiEndPoint\")を取得'),n(\"br\"),_._v(\"\\n　4-4-5. 添付ファイルパス\"),n(\"br\"),_._v(\"\\n　　・[4-3-4]でファイル出力したノリスケ送信ファイルパス\"),n(\"br\"),_._v(\"\\n　4-4-6. APIでスタッフ情報を送付する際に利用するSecretToken\"),n(\"br\"),_._v('\\n　　・ユーザー設定ファイル(\"ApiSetSecretToken\")を取得'),n(\"br\"),_._v('\\n　　・\"Bearer \" + 取得したSecretToken'),n(\"br\"),_._v(\"\\n4-5. 取得したAPI送信用の各設定値をHttpClientにセットし、ノリスケとAPI連携する\"),n(\"br\"),_._v(\"\\n　　・「ヘッダ」 - 「Authorization」：[4-4-6]で取得したSecretToken\"),n(\"br\"),_._v(\"\\n　　・エンドポイント：[4-4-4]で取得したURL\"),n(\"br\"),_._v(\"\\n　　・メソッド：POST\"),n(\"br\"),_._v(\"\\n　　・タイムアウト：[4-4-1]で取得したタイムアウト値\"),n(\"br\"),_._v(\"\\n　　・添付：[4-4-5]の添付ファイルパス\"),n(\"br\"),_._v(\"\\n　4-5-1. リターンコードが200以外、かつ[4-4-3]で取得したリトライ回数の上限に達していない場合、繰り返しAPI連携を行う\"),n(\"br\"),_._v(\"\\n　4-5-2. 連携時にException発生時はリターンコードに1000をセットする\"),n(\"br\"),_._v(\"\\n　4-5-3. リターンコードが200は連携成功、200以外はエラー。各リターンコードの内容に合うエラーログを出力する\"),n(\"br\"),_._v(\"\\n　　・400の場合：ファイル受付エラー\"),n(\"br\"),_._v(\"\\n　　・401の場合：認証エラー\"),n(\"br\"),_._v(\"\\n　　・413の場合：リクエストファイルサイズ超過エラー\"),n(\"br\"),_._v(\"\\n　　・上記以外の場合：上記以外のエラー内容\"),n(\"br\"),_._v(\"\\n4-6. Tmpフォルダ内のファイルを削除\"),n(\"br\"),_._v(\"\\n　4-6-1. Tmpフォルダのファイル情報を取得\"),n(\"br\"),_._v(\"\\n　4-6-2. 取得したファイル情報数分繰り返し、Tmpフォルダ内のファイルを削除する\"),n(\"br\"),_._v(\"\\n4-7. 処理中にエラーがある場合、終端処理へ\")])]),_._v(\" \"),n(\"li\",[n(\"p\",[_._v(\"終端処理\")])])])])}),[],!1,null,null,null);r.default=t.exports}}]);","extractedComments":[]}