{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[354],{864:function(_,t,v){\"use strict\";v.r(t);var e=v(42),r=Object(e.a)({},(function(){var _=this,t=_.$createElement,v=_._self._c||t;return v(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":_.$parent.slotKey}},[v(\"h1\",{attrs:{id:\"staff2000csvexport-xaml\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#staff2000csvexport-xaml\"}},[_._v(\"#\")]),_._v(\" Staff2000CSVExport.xaml\")]),_._v(\" \"),v(\"p\",[_._v(\"基幹システムからスタッフ情報ファイルをエクスポートする\")]),_._v(\" \"),v(\"h2\",{attrs:{id:\"引数\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#引数\"}},[_._v(\"#\")]),_._v(\" 引数\")]),_._v(\" \"),v(\"table\",[v(\"thead\",[v(\"tr\",[v(\"th\",[_._v(\"引数名\")]),_._v(\" \"),v(\"th\",[_._v(\"説明\")]),_._v(\" \"),v(\"th\",[_._v(\"方向\")]),_._v(\" \"),v(\"th\",[_._v(\"型\")]),_._v(\" \"),v(\"th\",[_._v(\"備考\")])])]),_._v(\" \"),v(\"tbody\",[v(\"tr\",[v(\"td\",[_._v(\"in_dicCommonSettings\")]),_._v(\" \"),v(\"td\",[_._v(\"共通設定ファイルの内容\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"Dictionary<String,Object>\")]),_._v(\" \"),v(\"td\",[_._v(\"HR_共通設定.xlsxの内容\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_dicUserSettings\")]),_._v(\" \"),v(\"td\",[_._v(\"ユーザー設定ファイルの内容\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"Dictionary<String,Object>\")]),_._v(\" \"),v(\"td\",[_._v(\"ユーザー設定.xlsxの内容\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_targetDate\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"DateTime\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"out_isSuccess\")]),_._v(\" \"),v(\"td\",[_._v(\"処理結果フラグ\")]),_._v(\" \"),v(\"td\",[_._v(\"出力\")]),_._v(\" \"),v(\"td\",[_._v(\"Boolean\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_pathDownloadCsvFile\")]),_._v(\" \"),v(\"td\",[_._v(\"基幹システムからエクスポートするスタッフ情報ファイルのパス\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"ファイル名：ExportStaffList.csv\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_pathSKM\")]),_._v(\" \"),v(\"td\",[_._v(\"Staff2000から出力する項目を指定するファイルのパス\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"ファイル名：出力スタッフ項目.SKM\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"out_errorMessage\")]),_._v(\" \"),v(\"td\",[_._v(\"エラーメッセージ\")]),_._v(\" \"),v(\"td\",[_._v(\"出力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_projectName\")]),_._v(\" \"),v(\"td\",[_._v(\"プロジェクト名\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"HRRA_001c_スタッフ出力\")])])])]),_._v(\" \"),v(\"br\"),_._v(\" \"),v(\"h2\",{attrs:{id:\"処理内容\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#処理内容\"}},[_._v(\"#\")]),_._v(\" 処理内容\")]),_._v(\" \"),v(\"ol\",[v(\"li\",[v(\"p\",[_._v(\"Staff2000ログイン\"),v(\"br\"),_._v(\"\\n　1-1. Staff2000のログイン処理呼び出し\"),v(\"br\"),_._v(\"\\n　　　基幹システムの各種設定の読み込み、起動を行うモジュールの呼び出し\"),v(\"br\"),_._v(\"\\n　　　・ \"),v(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_応募対応/スタッフ登録/詳細機能設計/HRRA_001c_スタッフ出力/xaml/Staff2000Login.html\"}},[_._v(\"Staff2000Login.xaml\")]),v(\"br\"),_._v(\"\\n　　　　引数\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_result = out_isSuccess\")]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"in_dicUserSettings = in_dicUserSettings\")]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"in_dicCommonSettings = in_dicCommonSettings\")]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_errorMessage = out_errorMessage\")]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"in_projectName = in_projectName\")]),v(\"br\"),_._v(\"\\n　　　　→Exception発生時はエラーフラグ、エラーメッセージをセットする。\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_isSuccess=False\")]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_errorMessage=exception.Message\")]),v(\"br\"),_._v(\"\\n　1-2. 絞り込み条件の解除処理呼び出し(\"),v(\"em\",[_._v(\"out_isSuccess=True\")]),_._v(\"の場合)\"),v(\"br\"),_._v(\"\\n　　　「絞込使用区分」から各項目の絞り込み解除を行うモジュールの呼び出し\"),v(\"br\"),_._v(\"\\n　　　・ \"),v(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_応募対応/スタッフ登録/詳細機能設計/HRRA_001c_スタッフ出力/xaml/Staff2000Unfilter.html\"}},[_._v(\"Staff2000Unfilter.xaml\")]),v(\"br\"),_._v(\"\\n　　　　引数\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_isSuccess = out_isSuccess\")]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_errorMessage = out_errorMessage\")]),v(\"br\"),_._v(\"\\n　　　　→Exception発生時はエラーフラグ、エラーメッセージをセットする。\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_isSuccess=False\")]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_errorMessage=exception.Message\")]),v(\"br\"),_._v(\"\\n　　　　→Exception発生時はスクリーンショットを取得する。\"),v(\"br\"),_._v(\"\\n　　　　　共通モジュール：TakeScreenshot.xamlの呼び出し\"),v(\"br\"),_._v(\"\\n　　　　　　引数\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v('in_elementScreen = \"\"')]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v('out_result = \"\"')]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v('in_imagePath = in_dicCommonSettings(\"MaintenanceFolder\").ToString +in_projectName + \"_\" + System.DateTime.Now.ToString(\"yyyyMMdd_HHmmss\")+\".jpg\"')])],1)]),_._v(\" \"),v(\"li\",[v(\"p\",[_._v(\"Staff2000ログイン処理結果\"),v(\"br\"),_._v(\"\\n　2-1. Staff2000Login.xamlの引数\"),v(\"em\",[_._v(\"out_result\")]),_._v(\"がFalseの場合、終了処理\")])]),_._v(\" \"),v(\"li\",[v(\"p\",[_._v(\"スタッフ情報ファイルのエクスポート\"),v(\"br\"),_._v(\"\\n　3-1. 「ｽﾀｯﾌﾏｽﾀ(項目設定)」画面への遷移\"),v(\"br\"),_._v(\"\\n　　→ 「Alt」キー ＋ 「a」キーを入力\"),v(\"br\"),_._v(\"\\n　　→ 「t」キーを入力\"),v(\"br\"),_._v(\"\\n　3-2. 「ｽﾀｯﾌﾏｽﾀ(項目設定)」画面への遷移結果確認がエラーの場合\"),v(\"br\"),_._v(\"\\n　　→ エラーメッセージをセットし、ExceptionをThrowする\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"エラーメッセージ：【契約開始スタッフ出力】「引当データ絞込」画面への遷移できない\")]),_._v(\"\\n　3-3. 出力先リスト「ファイルに保存」を選択\"),v(\"br\"),_._v(\"\\n　3-4. 右クリックでメニューの表示\"),v(\"br\"),_._v(\"\\n　3-5. メニュー「条件ﾌｧｲﾙ読出」を選択\"),v(\"br\"),_._v(\"\\n　3-6. SKMファイルの指定\"),v(\"br\"),_._v(\"\\n　　→ 引数：\"),v(\"em\",[_._v(\"in_pathSKM\")]),_._v(\"を指定する\"),v(\"br\"),_._v(\"\\n　3-7. ファイル出力の実行\"),v(\"br\"),_._v(\"\\n　　→ 「Ctrl」キー ＋ 「e」キーを入力\"),v(\"br\"),_._v(\"\\n　3-8. ファイル出力の開始\"),v(\"br\"),_._v(\"\\n　　→ 「はい」ボタンをクリック\"),v(\"br\"),_._v(\"\\n　3-9. 出力パスの指定\"),v(\"br\"),_._v(\"\\n　　→ 引数：\"),v(\"em\",[_._v(\"in_pathDownloadCsvFile\")]),_._v(\"を指定する\"),v(\"br\"),_._v(\"\\n　3-10. 「保存」ボタンをクリック\"),v(\"br\"),_._v(\"\\n　3-11. ファイルの出力が終了するまで待機する\"),v(\"br\"),_._v(\"\\n　　　　引数で指定したファイルのパスが見つかるまで、引数の時間繰り返しパスの確認をする\"),v(\"br\"),_._v(\"\\n　　　　共通モジュール：DownloadFileを待つ.xamlの呼び出し\"),v(\"br\"),_._v(\"\\n　　　　　引数\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"in_watchFilePath = in_pathDownloadCsvFile\")]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v('in_timeoutSecond = CInt(in_dicUserSettings(\"CoreSystemExportDelay\"))')]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_result = out_isSuccess\")]),v(\"br\"),_._v(\"\\n　3-12. 出力したファイルが見つからない場合(\"),v(\"em\",[_._v(\"out_result = False\")]),_._v(\")、エラーメッセージをセットし、ExceptionをThrowする\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v('エラーメッセージ：【出力ファイル存在確認】 「\"+Path.GetFileName(in_pathDownloadCsvFile)+\"」出力ファイルが存在しない')]),v(\"br\"),_._v(\"\\n　3-13. 出力したファイルは存在するが、中身が空の場合、エラーフラグをセット、エラーメッセージをセットする\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_isSuccess = False\")]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v('エラーメッセージ：「\"+Path.GetFileName(in_pathDownloadCsvFile)+\"」ファイルがダウンロードされましたが、データが存在しません。')]),v(\"br\"),_._v(\"\\n　3-14. Exception発生時\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"エラーメッセージ：CSVファイルのエクスポートに失敗しました。\")]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v(\"out_isSuccess = False\")]),v(\"br\"),_._v(\"\\n　　スクリーンショットを取得する。\"),v(\"br\"),_._v(\"\\n　　　共通モジュール：TakeScreenshot.xamlの呼び出し\"),v(\"br\"),_._v(\"\\n　　　引数\"),v(\"br\"),_._v(\" \"),v(\"em\",[_._v('in_elementScreen = \"\"')]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v('out_result = \"\"')]),v(\"br\"),_._v(\" \"),v(\"em\",[_._v('in_imagePath = in_dicCommonSettings(\"MaintenanceFolder\").ToString +in_projectName + \"_\" + System.DateTime.Now.ToString(\"yyyyMMdd_HHmmss\")+\".jpg\"')])])]),_._v(\" \"),v(\"li\",[v(\"p\",[_._v(\"終了処理\"),v(\"br\"),_._v(\"\\n　基幹システムが起動中の場合は終了させる\")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);","extractedComments":[]}