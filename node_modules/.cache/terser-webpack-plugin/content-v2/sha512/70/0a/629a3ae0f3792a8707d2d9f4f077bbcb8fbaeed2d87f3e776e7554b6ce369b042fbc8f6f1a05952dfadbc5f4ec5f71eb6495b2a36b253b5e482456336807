{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{584:function(_,v,r){\"use strict\";r.r(v);var n=r(42),a=Object(n.a)({},(function(){var _=this,v=_.$createElement,r=_._self._c||v;return r(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":_.$parent.slotKey}},[r(\"h1\",{attrs:{id:\"hrmc-001-案件情報ファイル取得-xaml-⏎\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#hrmc-001-案件情報ファイル取得-xaml-⏎\"}},[_._v(\"#\")]),_._v(\" HRMC_001_案件情報ファイル取得.xaml \"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRMC_マッチング/詳細機能設計/WF_HRMC_001_案件情報ファイル取得/WF_HRMC_001_案件情報ファイル取得.html\"}},[_._v(\"⏎\")])],1),_._v(\" \"),r(\"p\",[_._v(\"全体の処理フロー構成ファイル（ロボットが実行されるファイル）\")]),_._v(\" \"),r(\"h2\",{attrs:{id:\"引数\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#引数\"}},[_._v(\"#\")]),_._v(\" 引数\")]),_._v(\" \"),r(\"table\",[r(\"thead\",[r(\"tr\",[r(\"th\",[_._v(\"引数名\")]),_._v(\" \"),r(\"th\",[_._v(\"説明\")]),_._v(\" \"),r(\"th\",[_._v(\"方向\")]),_._v(\" \"),r(\"th\",[_._v(\"型\")]),_._v(\" \"),r(\"th\",[_._v(\"備考\")])])]),_._v(\" \"),r(\"tbody\",[r(\"tr\",[r(\"td\",[_._v(\"in_commonSettingsPath\")]),_._v(\" \"),r(\"td\",[_._v(\"共通設定のファイルパス \"),r(\"br\"),_._v(\"（即定値）D:\\\\diprpa\\\\共通\\\\HR_共通設定.xlsx\")]),_._v(\" \"),r(\"td\",[_._v(\"入力\")]),_._v(\" \"),r(\"td\",[_._v(\"String\")]),_._v(\" \"),r(\"td\",[_._v(\"－\")])]),_._v(\" \"),r(\"tr\",[r(\"td\",[_._v(\"in_projectName\")]),_._v(\" \"),r(\"td\",[_._v(\"プロジェクト名 \"),r(\"br\"),_._v(\"（即定値）HRMC_001_案件情報ファイル取得\")]),_._v(\" \"),r(\"td\",[_._v(\"入力\")]),_._v(\" \"),r(\"td\",[_._v(\"String\")]),_._v(\" \"),r(\"td\",[_._v(\"－\")])]),_._v(\" \"),r(\"tr\",[r(\"td\",[_._v(\"in_projectVersion\")]),_._v(\" \"),r(\"td\",[_._v(\"プロジェクトのバージョン \"),r(\"br\"),_._v(\"（即定値）1.0\")]),_._v(\" \"),r(\"td\",[_._v(\"入力\")]),_._v(\" \"),r(\"td\",[_._v(\"String\")]),_._v(\" \"),r(\"td\",[_._v(\"－\")])])])]),_._v(\" \"),r(\"br\"),_._v(\" \"),r(\"h2\",{attrs:{id:\"処理内容\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#処理内容\"}},[_._v(\"#\")]),_._v(\" 処理内容\")]),_._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[_._v(\"初期処理\"),r(\"br\"),_._v(\"\\n　1-1. プロジェクト名の設定\"),r(\"br\"),_._v(\"\\n　1-2. 処理開始時間の取得\"),r(\"br\"),_._v(\"\\n　1-3. 共通設定の読込\"),r(\"br\"),_._v(\"\\n　1-4. ユーザー設定、プロジェクト設定のファイル存在確認\"),r(\"br\"),_._v(\"\\n　1-5. ユーザー設定、プロジェクト設定の読込\"),r(\"br\"),_._v(\"\\n　1-6. Excel全クローズ\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"必須情報の有無\"),r(\"br\"),_._v(\"\\n　2-1. 共通設定の項目確認\"),r(\"br\"),_._v(\"\\n　2-2. プロジェクト設定の項目確認\"),r(\"br\"),_._v(\"\\n　2-3. ユーザー設定の項目確認\"),r(\"br\"),_._v(\"\\n　2-4. フォルダの存在確認・作成\"),r(\"br\"),_._v(\"\\n　2-5. フォルダパス・ファイルパスの設定\"),r(\"br\"),_._v(\"\\n　2-6. 必須ファイルの存在確認\"),r(\"br\"),_._v(\"\\n　2-7. 必要情報取得の結果確認\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"前回実行時のファイル削除\"),r(\"br\"),_._v(\"\\n　3-1. 前回実行時ファイルの削除\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"案件情報ファイルの取得　※getOrderInfo.xaml 使用\"),r(\"br\"),_._v(\"\\n　4-1. 接続資格情報ファイルの読込\"),r(\"br\"),_._v(\"\\n　4-2. 案件情報ファイル名の取得\"),r(\"br\"),_._v(\"\\n　　4-2-1. HTTPリクエスト作成の必要データ取得\"),r(\"br\"),_._v(\"\\n　　4-2-2. 署名の作成\"),r(\"br\"),_._v(\"\\n　　4-2-3. ファイル名取得の実施\"),r(\"br\"),_._v(\"\\n　4-3. 案件情報ファイルの取得\"),r(\"br\"),_._v(\"\\n　　4-3-1. HTTPリクエスト作成の必要データ取得\"),r(\"br\"),_._v(\"\\n　　4-3-2. 署名の作成\"),r(\"br\"),_._v(\"\\n　　4-3-3. ファイル取得の実施\"),r(\"br\"),_._v(\"\\n　4-4. 案件情報ファイルの削除\"),r(\"br\"),_._v(\"\\n　　4-4-1. HTTPリクエスト作成の必要データ取得\"),r(\"br\"),_._v(\"\\n　　4-4-2. 署名の作成\"),r(\"br\"),_._v(\"\\n　　4-4-3. ファイル削除の実施\"),r(\"br\"),_._v(\"\\n　4-5. ダウンロードファイルのファイル名変更\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"案件情報データチェック\"),r(\"br\"),_._v(\"\\n　5-1. 案件情報ファイルの読込\"),r(\"br\"),_._v(\"\\n　　・抽出元：HRBC_ProjectTable_yyyyMMdd_hhmmss.csvのファイルパス(\\\\in)\"),r(\"br\"),_._v(\"\\n　　・格納先：受注案件一覧(DataTable)\"),r(\"br\"),_._v(\"\\n　5-2. 受注案件一覧(DataTable)に登録成否チェック列を追加\"),r(\"br\"),_._v(\"\\n　　・追加列：\"),r(\"br\"),_._v(\"\\n　　　　成否フラグ(Boolean)\"),r(\"br\"),_._v(\"\\n　5-3. 案件情報のデータ確認　※importDataValidation.xaml 使用\"),r(\"br\"),_._v(\"\\n　5-4. 入力値不備の存在確認\"),r(\"br\"),_._v(\"\\n　5-5. 入力値不備一覧CSVファイルの作成\"),r(\"br\"),_._v(\"\\n　　・出力条件：受注案件一覧(DataTable)の成否フラグ = False\"),r(\"br\"),_._v(\"\\n　　・出力対象：受注案件一覧(DataTable)\"),r(\"br\"),_._v(\"\\n　　・出力先：入力値不備一覧のファイルパス\"),r(\"br\"),_._v(\"\\n　　　　　　　(C:\\\\diprpa\\\\プロジェクト名\\\\tmp\\\\incompleteValueList_ yyyyMMdd_hhmmss.csv）\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"受注案件登録対象データ作成\"),r(\"br\"),_._v(\"\\n　6-1. 受注案件登録対象の抽出\"),r(\"br\"),_._v(\"\\n　　・抽出条件：受注案件一覧(DataTable)の成否フラグ = True\"),r(\"br\"),_._v(\"\\n　　・抽出先：受注案件登録一覧(DataTable)\"),r(\"br\"),_._v(\"\\n　6-2. 受注案件登録対象の存在確認\"),r(\"br\"),_._v(\"\\n　6-3. 引当者複数人の設定\"),r(\"br\"),_._v(\"\\n　　6-3-1. 受注案件登録一覧(DataTable)]のレコード数分、以下を実施\"),r(\"br\"),_._v(\"\\n　　　引当者複数人対応のフィルタ\"),r(\"br\"),_._v(\"\\n　　　・確認対象：[受注案件登録一覧(DataRow)]\"),r(\"br\"),_._v(\"\\n　　　・格納先：フィルタ結果(DataTable)\"),r(\"br\"),_._v(\"\\n　　　・条件\"),r(\"br\"),_._v(\"\\n　　　　　成約実績ID：一致\"),r(\"br\"),_._v(\"\\n　　　　　引当者複数登録フラグ(Boolean) ：Null\"),r(\"br\"),_._v(\"\\n　　　　　引当者登録番号(int)：Null\"),r(\"br\"),_._v(\"\\n　　　6-3-1-1. フィルタ結果が0件以上の場合、フィルタ結果のレコード数分、以下を実施\"),r(\"br\"),_._v(\"\\n　　　　・条件：フィルタ結果のレジュメID と 受注案件登録一覧(DataTable)のレジュメID が一致\"),r(\"br\"),_._v(\"\\n　　　　・値設定：\"),r(\"br\"),_._v(\"\\n　　　　　　受注案件登録一覧(DataTable) の 引当者複数登録フラグ = True\"),r(\"br\"),_._v(\"\\n　　　　　　受注案件登録一覧(DataTable) の 引当者登録番号 採番（1からナンバリング)\"),r(\"br\"),_._v(\"\\n　　　　　　受注案件登録一覧(DataTable) の 引当者登録人数 = フィルタ結果.count\"),r(\"br\"),_._v(\"\\n　6-4. データ確認用テーブルファイルの読込\"),r(\"br\"),_._v(\"\\n　　・抽出元：matchingProjectTable.csv(プロジェクト設定)\"),r(\"br\"),_._v(\"\\n　　・格納先：データ確認用テーブル(DataTable)\"),r(\"br\"),_._v(\"\\n　6-5. 受注案件登録ファイルの作成\"),r(\"br\"),_._v(\"\\n　　6-5-1. 受注案件登録一覧(DataTable)のレコード数分、以下を実施\"),r(\"br\"),_._v(\"\\n　　　データ確認用テーブル(DataTable)と受注案件登録一覧(DataTable)の比較し、\"),r(\"br\"),_._v(\"\\n　　　データ確認用テーブルに該当項目がある場合、受注案件登録一覧(DataTable)に反映\"),r(\"br\"),_._v(\"\\n　　　（繰り返し処理の際、各行に連番を振る）\"),r(\"br\"),_._v(\"\\n　　　・条件\"),r(\"br\"),_._v(\"\\n　　　　　レジュメID、氏名（漢字）、氏名（カナ）、生年月日が一致：スタッフ番号を取得\"),r(\"br\"),_._v(\"\\n　　　　　企業ID、クライアント名が一致：クライアント番号を取得\"),r(\"br\"),_._v(\"\\n　　　　　企業ID、クライアント名、請求先部署名が一致：請求先番号を取得\"),r(\"br\"),_._v(\"\\n　　　　　企業ID、クライアント名、就業先部署名が一致：就業先番号を取得\"),r(\"br\"),_._v(\"\\n　　　　　企業ID、クライアント名、事業所名が一致：事業所番号を取得\"),r(\"br\"),_._v(\"\\n　　　　　繰り返し処理の際、各行に連番を振る\"),r(\"br\"),_._v(\"\\n　　6-5-2. 受注案件登録対象一覧の作成\"),r(\"br\"),_._v(\"\\n　　　・設定値：受注案件登録一覧(DataTable)\"),r(\"br\"),_._v(\"\\n　　　・出力対象：受注案件登録対象一覧のファイルパス\"),r(\"br\"),_._v(\"\\n　　　・出力先：C:\\\\diprpa\\\\プロジェクト名\\\\out(orderRegisterList_yyyyMMdd_hhmmss.csv)\"),r(\"br\"),_._v(\"\\n　　6-5-3. 受注案件登録一覧(DataTable)をmatchingProjectTable.csvに追記\"),r(\"br\"),_._v(\"\\n　　　※追記時、番号はmatchingProjectTable.csvでの連番を採番する\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"終了処理\"),r(\"br\"),_._v(\"\\n　7-1. 案件情報ファイルの移動\"),r(\"br\"),_._v(\"\\n　　・対象：HRBC_ProjectTable_yyyyMMdd_hhmmdd.csv\"),r(\"br\"),_._v(\"\\n　　・格納先：C:\\\\diprpa\\\\共通\\\\matching\\\\Storage（プロジェクト設定ファイル）\"),r(\"br\"),_._v(\"\\n　7-2. 入力値不備メール送信\"),r(\"br\"),_._v(\"\\n　　入力値不備一覧ファイルの存在する場合、入力値不備一覧ファイルを読み込み、\"),r(\"br\"),_._v(\"\\n　　メール本文に追記して、登録結果通知メールCSVファイルを作成後、BulkMailSend.xamlによるメール送信を行う\"),r(\"br\"),_._v(\"\\n　7-3. 一時格納ファイルの削除\"),r(\"br\"),_._v(\"\\n　　プロジェクトで使用した一時格納ファイルの削除(ファイルが存在している場合に削除を実施する)\"),r(\"br\"),_._v(\"\\n　　・対象フォルダ：C:\\\\diprpa\\\\プロジェクト名\\\\tmp\"),r(\"br\"),_._v(\"\\n　7-4. 保存期間外となった案件情報ファイルの削除\"),r(\"br\"),_._v(\"\\n　　C:\\\\diprpa\\\\共通\\\\matching\\\\Storageに格納されているファイルからファイル名の日時情報が、\"),r(\"br\"),_._v(\"\\n　　保存日数（ユーザー設定のfileStoragePeriod）以前のファイルを削除する\")])])])])}),[],!1,null,null,null);v.default=a.exports}}]);","extractedComments":[]}