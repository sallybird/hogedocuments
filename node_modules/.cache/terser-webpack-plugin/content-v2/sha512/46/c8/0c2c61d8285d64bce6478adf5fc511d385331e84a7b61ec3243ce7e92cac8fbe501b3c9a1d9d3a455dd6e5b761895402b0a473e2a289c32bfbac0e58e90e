{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[181],{670:function(_,t,r){\"use strict\";r.r(t);var v=r(42),n=Object(v.a)({},(function(){var _=this,t=_.$createElement,r=_._self._c||t;return r(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":_.$parent.slotKey}},[r(\"h1\",{attrs:{id:\"hrra-006a-契約終了日スタッフ通知-xaml\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#hrra-006a-契約終了日スタッフ通知-xaml\"}},[_._v(\"#\")]),_._v(\" HRRA_006a_契約終了日スタッフ通知.xaml\")]),_._v(\" \"),r(\"p\",[_._v(\"指定した期間内に契約終了日を迎えるスタッフ情報をHR企業の担当者にメールで通知する\")]),_._v(\" \"),r(\"h2\",{attrs:{id:\"引数\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#引数\"}},[_._v(\"#\")]),_._v(\" 引数\")]),_._v(\" \"),r(\"table\",[r(\"thead\",[r(\"tr\",[r(\"th\",[_._v(\"引数名\")]),_._v(\" \"),r(\"th\",[_._v(\"説明\")]),_._v(\" \"),r(\"th\",[_._v(\"方向\")]),_._v(\" \"),r(\"th\",[_._v(\"型\")]),_._v(\" \"),r(\"th\",[_._v(\"備考\")])])]),_._v(\" \"),r(\"tbody\",[r(\"tr\",[r(\"td\",[_._v(\"StaNaviCsvDataTable\")]),_._v(\" \"),r(\"td\",[_._v(\"ファイルパス\")]),_._v(\" \"),r(\"td\",[_._v(\"入力\")]),_._v(\" \"),r(\"td\",[_._v(\"Datatable\")]),_._v(\" \"),r(\"td\",[_._v(\"－\")])]),_._v(\" \"),r(\"tr\",[r(\"td\",[_._v(\"in_projectName\")]),_._v(\" \"),r(\"td\",[_._v(\"プロジェクト名\")]),_._v(\" \"),r(\"td\",[_._v(\"入力\")]),_._v(\" \"),r(\"td\",[_._v(\"String\")]),_._v(\" \"),r(\"td\",[_._v('既定値：\"HRRA_006a_契約終了日スタッフ通知\"')])]),_._v(\" \"),r(\"tr\",[r(\"td\",[_._v(\"in_commonSettingPath\")]),_._v(\" \"),r(\"td\",[_._v(\"共通設定ファイルパス\")]),_._v(\" \"),r(\"td\",[_._v(\"出力\")]),_._v(\" \"),r(\"td\",[_._v(\"Boolean\")]),_._v(\" \"),r(\"td\",[_._v('既定値：\"c:\\\\diprpa\\\\共通\\\\HR_共通設定.xlsx\"')])])])]),_._v(\" \"),r(\"br\"),_._v(\" \"),r(\"h2\",{attrs:{id:\"処理内容\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#処理内容\"}},[_._v(\"#\")]),_._v(\" 処理内容\")]),_._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[_._v(\"初期処理\"),r(\"br\"),_._v(\"\\n1-1. プロジェクト名の設定\"),r(\"br\"),_._v(\"\\n1-2. 処理開始時間の取得\"),r(\"br\"),_._v(\"\\n1-3. 共通設定のファイル存在確認・読込\"),r(\"br\"),_._v(\"\\n1-4. システムルートフォルダ存在確認\"),r(\"br\"),_._v(\"\\n1-5. プロジェクト専用フォルダ存在確認\"),r(\"br\"),_._v(\"\\n1-6. ユーザー設定のファイル存在確認・読込\"),r(\"br\"),_._v(\"\\n1-7. プロジェクト設定のファイル存在確認・読込\"),r(\"br\"),_._v(\"\\n1-8. エラーメッセージ設定ファイルの存在確認・読込\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"初期処理のエラー判定\"),r(\"br\"),_._v(\"\\n・1.初期処理でエラーが発生した場合,例外をThrowする\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"設定情報の確認\"),r(\"br\"),_._v(\"\\n3-1. 共通モジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/common_workflow/設定文字列確認.html\"}},[r(\"strong\",[_._v(\"設定文字列確認.xaml\")])]),_._v(\"」を呼び出し、「プロジェクト設定xlsx」ファイルから各設定値を取得する\"),r(\"br\"),_._v(\"\\n　・「commonFolder」を取得\"),r(\"br\"),_._v(\"\\n　・「tmpFolder」を取得\"),r(\"br\"),_._v(\"\\n　・「mailSendFolder」を取得\"),r(\"br\"),_._v(\"\\n　・「mailCompFolder」を取得\"),r(\"br\"),_._v(\"\\n　・「TempContractComp」を取得\"),r(\"br\"),_._v(\"\\n　・「orderNo」を取得\"),r(\"br\"),_._v(\"\\n　・「orderName」を取得\"),r(\"br\"),_._v(\"\\n　・「signingDate」を取得\"),r(\"br\"),_._v(\"\\n　・「repName」を取得\"),r(\"br\"),_._v(\"\\n　・「clientNo」を取得\"),r(\"br\"),_._v(\"\\n　・「clientName」を取得\"),r(\"br\"),_._v(\"\\n　・「targetDeptNo」を取得\"),r(\"br\"),_._v(\"\\n　・「targetDeptName」を取得\"),r(\"br\"),_._v(\"\\n　・「staffNo」を取得\"),r(\"br\"),_._v(\"\\n　・「staffName」を取得\"),r(\"br\"),_._v(\"\\n　・「tempingStart」を取得\"),r(\"br\"),_._v(\"\\n　・「tempingEnd」を取得\"),r(\"br\"),_._v(\"\\n　・「employmentStart」を取得\"),r(\"br\"),_._v(\"\\n　・「employmentEnd」を取得\"),r(\"br\"),_._v(\"\\n3-2. 「ユーザー設定.xlsx」ファイルの値を確認する\"),r(\"br\"),_._v(\"\\n　3-2-1. サブモジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/契約終了日スタッフ通知/詳細機能設計/WF_HRRA_006a_契約終了日スタッフ通知/xaml/UserSettingValueCheck.html\"}},[r(\"strong\",[_._v(\"UserSettingValueCheck.xaml\")])]),_._v(\"」を呼び出し、「ユーザー設定.xlsx」ファイルの値を補正する。\"),r(\"br\"),_._v(\"\\n　3-2-2. 「ユーザー設定.xlsx」ファイル内の値を取得し、各型に変換する\"),r(\"br\"),_._v(\"\\n　　・「timeOut」をInt32に変換する\"),r(\"br\"),_._v(\"\\n　　・「retryCount」をInt32に変換する\"),r(\"br\"),_._v(\"\\n　　・「retryTime」をInt32に変換する\"),r(\"br\"),_._v(\"\\n　　・「searchAddMonths」をInt32に変換する\"),r(\"br\"),_._v(\"\\n　　・「searchAddDays」をInt32に変換する\"),r(\"br\"),_._v(\"\\n　　・「contractStaffDelete」をInt32に変換する\"),r(\"br\"),_._v(\"\\n　　・「outputFilePath」をStringに変換する\"),r(\"br\"),_._v(\"\\n　3-2-3. 「ユーザー設定.xlsx」ファイル内からショートカットキーの「ShortcutKeyToSelectContractList」を取得する\"),r(\"br\"),_._v(\"\\n　3-2-4. サブモジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/契約終了日スタッフ通知/詳細機能設計/WF_HRRA_006a_契約終了日スタッフ通知/xaml/FolderInitialization.html\"}},[r(\"strong\",[_._v(\"FolderInitialization.xaml\")])]),_._v(\"」を呼び出し、メール送信前フォルダ(mailSendFolder)のフォルダを初期化する\"),r(\"br\"),_._v(\"\\n　3-2-5. サブモジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/契約終了日スタッフ通知/詳細機能設計/WF_HRRA_006a_契約終了日スタッフ通知/xaml/FolderInitialization.html\"}},[r(\"strong\",[_._v(\"FolderInitialization.xaml\")])]),_._v(\"」を呼び出し、メール送信後フォルダ(mailCompFolder)のフォルダを初期化する\"),r(\"br\"),_._v(\"\\n　3-2-6. サブモジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/契約終了日スタッフ通知/詳細機能設計/WF_HRRA_006a_契約終了日スタッフ通知/xaml/FolderInitialization.html\"}},[r(\"strong\",[_._v(\"FolderInitialization.xaml\")])]),_._v(\"」を呼び出し、一時格納フォルダ(tmpFolder)のフォルダを初期化する\"),r(\"br\"),_._v(\"\\n　3-2-7. サブモジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/契約終了日スタッフ通知/詳細機能設計/WF_HRRA_006a_契約終了日スタッフ通知/xaml/CheckFile.xaml.html\"}},[r(\"strong\",[_._v(\"CheckFile.xaml\")])]),_._v(\"」を呼び出し、メールテンプレートファイル(TempContractComp)の存在確認をする\"),r(\"br\"),_._v(\"\\n　3-2-8. サブモジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/契約終了日スタッフ通知/詳細機能設計/WF_HRRA_006a_契約終了日スタッフ通知/xaml/CreateFolder.html\"}},[r(\"strong\",[_._v(\"CreateFolder.xaml\")])]),_._v(\"」を呼び出し、出力先フォルダ(outputFilePath)のフォルダを作成する\"),r(\"br\"),_._v(\"\\n3-3. 「HR_共通設定.xlsx」、「ユーザー設定.xlsx」ファイルからメールアドレスを取得する\"),r(\"br\"),_._v(\"\\n　3-3-1. ユーザー設定からメールアドレス(To)を取得\"),r(\"br\"),_._v(\"\\n　　・取得できない場合、共通設定からメールアドレス(To)を取得\"),r(\"br\"),_._v(\"\\n　3-3-2. ユーザー設定からメールアドレス(Cc)を取得\"),r(\"br\"),_._v(\"\\n　　・取得できない場合、共通設定からメールアドレス(Cc)を取得\"),r(\"br\"),_._v(\"\\n　3-3-3. ユーザー設定からメールアドレス(Bcc)を取得\"),r(\"br\"),_._v(\"\\n　　・取得できない場合、共通設定からメールアドレス(Bcc)を取得\"),r(\"br\"),_._v(\"\\n　　※1 取得したメールアドレスはメール形式(正規表現)のチェックを行う\"),r(\"br\"),_._v(\"\\n　　※2 取得したメールアドレスがカンマ区切りで複数存在する場合、メールアドレスをセミコロン(;)で結合する\")],1),_._v(\" \"),r(\"p\",[_._v(\"3-4. 契約終了日の検索条件を生成\"),r(\"br\"),_._v(\"\\n　3-4-1. 契約終了日(From)の生成\"),r(\"br\"),_._v(\"\\n　　・処理実行日 + 「searchAddDays」\"),r(\"br\"),_._v(\"\\n　3-4-2. 契約終了日(To)の生成\"),r(\"br\"),_._v(\"\\n　　・契約終了日(From) + 「searchAddMonths」の月末日\"),r(\"br\"),_._v(\"\\n　3-4-3. 検索条件文字列を生成\"),r(\"br\"),_._v('\\n　　・契約終了日(From)を\"yyyy/MM/dd\"に変換、契約終了日(To)を\"yyyy/MM/dd\"に変換し\"~\"文字列で結合する'),r(\"br\"),_._v(\"\\n　　例）「2020/10/2 ~ 2020/11/30」\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"基幹システム(Staff Navigator)の操作\"),r(\"br\"),_._v(\"\\n4-1. サブモジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/契約終了日スタッフ通知/詳細機能設計/WF_HRRA_006a_契約終了日スタッフ通知/xaml/StaffNavigatorStart.html\"}},[r(\"strong\",[_._v(\"StaffNavigatorStart.xaml\")])]),_._v(\"」を呼び出し、Staff Navigatorの起動、ログインを行う\"),r(\"br\"),_._v(\"\\n4-2. 契約一覧CSVファイルの出力を行う\"),r(\"br\"),_._v(\"\\n　・サブモジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/契約終了日スタッフ通知/詳細機能設計/WF_HRRA_006a_契約終了日スタッフ通知/xaml/StaffNavigatorCsvOutput.html\"}},[r(\"strong\",[_._v(\"StaffNavigatorCsvOutput.xaml\")])]),_._v(\"」を呼び出し、契約一覧CSVファイルを出力する\")],1)]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"基幹システム操作のエラー判定\"),r(\"br\"),_._v(\"\\n5-1. 基幹システムの起動、ログインで失敗した場合\"),r(\"br\"),_._v(\"\\n　・例外をThrowする\"),r(\"br\"),_._v(\"\\n5-2. 契約一覧CSVファイルが出力されなかった場合\"),r(\"br\"),_._v(\"\\n　・共通モジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/common_workflow/終端処理.html\"}},[r(\"strong\",[_._v(\"終端処理.xaml\")])]),_._v(\"」を呼び出し、処理終了\")],1)]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"契約一覧CSVファイルの確認\"),r(\"br\"),_._v(\"\\n6-1. 契約一覧CSVファイルの存在確認をする\"),r(\"br\"),_._v(\"\\n6-2. 契約一覧CSVファイルが存在しない場合\"),r(\"br\"),_._v(\"\\n　・例外をThrowする\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"契約一覧CSVファイルの加工\"),r(\"br\"),_._v(\"\\n7-1. 契約一覧CSVファイルから必要な列を絞る\"),r(\"br\"),_._v(\"\\n　・「クライアント番号」\"),r(\"br\"),_._v(\"\\n　・「クライアント名」\"),r(\"br\"),_._v(\"\\n　・「就業先部署名」\"),r(\"br\"),_._v(\"\\n　・「契約期間（受注）－開始日」\"),r(\"br\"),_._v(\"\\n　・「契約期間（受注）－終了日」\"),r(\"br\"),_._v(\"\\n　・「スタッフ番号」\"),r(\"br\"),_._v(\"\\n　・「スタッフ名」\"),r(\"br\"),_._v(\"\\n　・「契約期間（引当）－開始日」\"),r(\"br\"),_._v(\"\\n　・「契約期間（引当）－終了日」\"),r(\"br\"),_._v(\"\\n7-2. 「契約期間（引当）－終了日」の昇順で並べ替える\"),r(\"br\"),_._v(\"\\n7-3. 契約終了日スタッフ情報ファイルを出力する\"),r(\"br\"),_._v(\"\\n　・出力パス：「outputFilePath」\"),r(\"br\"),_._v('\\n　・ファイル名：\"HRRA_006a_契約終了日スタッフ通知_\" ＋ 処理実行日(yyyyMMdd_HHmmss) ＋ \".csv\"'),r(\"br\"),_._v(\"\\n7-4. CSVファイルの加工でエラーが発生した場合\"),r(\"br\"),_._v(\"\\n　・例外をThrowする\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"送信用ファイルの作成\"),r(\"br\"),_._v(\"\\n8-1. メールテンプレートの読み込む\"),r(\"br\"),_._v(\"\\n　・「TempContractComp」パスからメールテンプレートファイルを読み込む\"),r(\"br\"),_._v(\"\\n8-2. 読み込んだ列の値を更新または置換する\"),r(\"br\"),_._v(\"\\n　8-2-1.「send_to」列の値を取得したメールアドレス(To)で更新する\"),r(\"br\"),_._v(\"\\n　8-2-2.「send_cc」列の値を取得したメールアドレス(Cc)で更新する\"),r(\"br\"),_._v(\"\\n　8-2-3.「send_to」列の値を取得したメールアドレス(Bcc)で更新する\"),r(\"br\"),_._v(\"\\n　8-2-4.「body」列内の「YYYY/MM/DD～YYYY/MM/DD」を「検索条件文字列」で置換する\"),r(\"br\"),_._v(\"\\n　8-2-5.「body」列内の「＜契約終了日スタッフ情報ファイルパス＞」を「契約終了日スタッフ情報ファイルのパス」で置換する\"),r(\"br\"),_._v(\"\\n8-3. 更新したテンプレートの内容をメールファイルとして書き出す\"),r(\"br\"),_._v(\"\\n　・出力パス：「mailSendFolder」\"),r(\"br\"),_._v('\\n　・ファイル名：\"Mail_StaffNavi_contractComp.csv\"'),r(\"br\"),_._v(\"\\n8-4. 共通モジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/共通/共通モジュール/mail_workflow/BulkMailSend.html\"}},[r(\"strong\",[_._v(\"BulkMailSend.xaml\")])]),_._v(\"」を呼び出し、作成したメールファイルをメール送信する\\n8-5. メール送信処理で失敗した場合\"),r(\"br\"),_._v(\"\\n　・例外をThrowする\")],1)]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"正常終了処理\\n9-1. 作成したファイルの削除\"),r(\"br\"),_._v(\"\\n　・サブモジュール「\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_アラート通知/契約終了日スタッフ通知/詳細機能設計/WF_HRRA_006a_契約終了日スタッフ通知/xaml/FolderInitialization.html\"}},[r(\"strong\",[_._v(\"FolderInitialization.xaml\")])]),_._v(\"」を呼び出し、「mailSendFolder」、「mailCompFolder」、「tmpFolder」ファルダを初期化し、フォルダ内のファイルを削除する\")],1)]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"終端処理\")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);","extractedComments":[]}