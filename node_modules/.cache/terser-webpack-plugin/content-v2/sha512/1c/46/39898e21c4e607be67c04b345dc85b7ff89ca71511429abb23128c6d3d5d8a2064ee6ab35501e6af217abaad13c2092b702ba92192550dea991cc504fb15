{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{624:function(_,t,v){\"use strict\";v.r(t);var a=v(42),r=Object(a.a)({},(function(){var _=this,t=_.$createElement,v=_._self._c||t;return v(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":_.$parent.slotKey}},[v(\"h1\",{attrs:{id:\"createcsvforsendingemail-xaml\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#createcsvforsendingemail-xaml\"}},[_._v(\"#\")]),_._v(\" CreateCsvForSendingEmail.xaml\")]),_._v(\" \"),v(\"p\",[_._v(\"初回就業日通知メールのCSVファイルを作成する\"),v(\"br\"),_._v(\"\\nCSVファイルを作成した場合は送信済ファイル、作成できなかった場合は未送信者ファイルに該当の契約情報を出力する\")]),_._v(\" \"),v(\"h2\",{attrs:{id:\"引数\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#引数\"}},[_._v(\"#\")]),_._v(\" 引数\")]),_._v(\" \"),v(\"table\",[v(\"thead\",[v(\"tr\",[v(\"th\",[_._v(\"引数名\")]),_._v(\" \"),v(\"th\",[_._v(\"説明\")]),_._v(\" \"),v(\"th\",[_._v(\"方向\")]),_._v(\" \"),v(\"th\",[_._v(\"型\")]),_._v(\" \"),v(\"th\",[_._v(\"備考\")])])]),_._v(\" \"),v(\"tbody\",[v(\"tr\",[v(\"td\",[_._v(\"in_dicAppSettings\")]),_._v(\" \"),v(\"td\",[_._v(\"プロジェクト設定情報\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"Dictionary<String, Object>\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_processDate\")]),_._v(\" \"),v(\"td\",[_._v(\"処理日\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"DateTime\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_staNaviCsvFileName\")]),_._v(\" \"),v(\"td\",[_._v(\"契約一覧CSVファイルパス\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"out_staNaviDataTable\")]),_._v(\" \"),v(\"td\",[_._v(\"契約一覧情報\")]),_._v(\" \"),v(\"td\",[_._v(\"出力\")]),_._v(\" \"),v(\"td\",[_._v(\"DataTable\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_staffCsvFile\")]),_._v(\" \"),v(\"td\",[_._v(\"スタッフ情報CSVファイルパス\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"out_staffDataTable\")]),_._v(\" \"),v(\"td\",[_._v(\"スタッフ情報\")]),_._v(\" \"),v(\"td\",[_._v(\"出力\")]),_._v(\" \"),v(\"td\",[_._v(\"DataTable\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_lastSentListCsvFile\")]),_._v(\" \"),v(\"td\",[_._v(\"送信済ファイルパス\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"out_thisSentListDataTable\")]),_._v(\" \"),v(\"td\",[_._v(\"送信者リスト\")]),_._v(\" \"),v(\"td\",[_._v(\"出力\")]),_._v(\" \"),v(\"td\",[_._v(\"DataTable\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"out_unsentListDataTable\")]),_._v(\" \"),v(\"td\",[_._v(\"未送信者リスト\")]),_._v(\" \"),v(\"td\",[_._v(\"出力\")]),_._v(\" \"),v(\"td\",[_._v(\"DataTable\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_errorNumber\")]),_._v(\" \"),v(\"td\",[_._v(\"入力エラー番号\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"out_errorNumber\")]),_._v(\" \"),v(\"td\",[_._v(\"出力エラー番号\")]),_._v(\" \"),v(\"td\",[_._v(\"出力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_templateFile\")]),_._v(\" \"),v(\"td\",[_._v(\"初回就業日通知メールテンプレートファイルパス\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_tmpSendFolder\")]),_._v(\" \"),v(\"td\",[_._v(\"初回就業日通知メールCSVファイル格納先フォルダパス\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"out_targetNumber\")]),_._v(\" \"),v(\"td\",[_._v(\"対象者数\")]),_._v(\" \"),v(\"td\",[_._v(\"出力\")]),_._v(\" \"),v(\"td\",[_._v(\"Int32\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"out_createMailCsvNumber\")]),_._v(\" \"),v(\"td\",[_._v(\"CSV作成数\")]),_._v(\" \"),v(\"td\",[_._v(\"出力\")]),_._v(\" \"),v(\"td\",[_._v(\"Int32\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"out_isSuccess\")]),_._v(\" \"),v(\"td\",[_._v(\"処理結果フラグ\")]),_._v(\" \"),v(\"td\",[_._v(\"出力\")]),_._v(\" \"),v(\"td\",[_._v(\"Boolean\")]),_._v(\" \"),v(\"td\",[_._v(\"－\")])]),_._v(\" \"),v(\"tr\",[v(\"td\",[_._v(\"in_unSentListFile\")]),_._v(\" \"),v(\"td\",[_._v(\"未送信者ファイルパス\")]),_._v(\" \"),v(\"td\",[_._v(\"入力\")]),_._v(\" \"),v(\"td\",[_._v(\"String\")]),_._v(\" \"),v(\"td\",[_._v(\"未使用\")])])])]),_._v(\" \"),v(\"br\"),_._v(\" \"),v(\"h2\",{attrs:{id:\"処理内容\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#処理内容\"}},[_._v(\"#\")]),_._v(\" 処理内容\")]),_._v(\" \"),v(\"ol\",[v(\"li\",[v(\"p\",[_._v(\"契約一覧CSVファイルパス（引数：in_staNaviCsvFileName）のデータを契約一覧情報（引数：out_staNaviDataTable）に出力する\")])]),_._v(\" \"),v(\"li\",[v(\"p\",[_._v(\"スタッフ情報CSVファイルパス（引数：in_staffCsvFile）のデータをスタッフ情報（引数：out_staffDataTable）に出力する\")])]),_._v(\" \"),v(\"li\",[v(\"p\",[_._v(\"送信済ファイルパス（引数：in_lastSentListCsvFile）のデータを取得する\")])]),_._v(\" \"),v(\"li\",[v(\"p\",[_._v(\"上記1で出力した契約一覧情報（引数：out_staNaviDataTable）をもとにデータ分、以下の処理をする\"),v(\"br\"),_._v(\"\\n4-1. 送信済スタッフの場合、次データの処理へ移る\"),v(\"br\"),_._v(\"\\n　対象：上記3で取得したデータに契約一覧情報（引数：out_staNaviDataTable）の\"),v(\"br\"),_._v(\"\\n　　　　スタッフ番号と受注番号が一致するデータが存在する\")]),_._v(\" \"),v(\"p\",[_._v(\"4-2. 対象者数（引数：out_targetNumber）を＋１カウントする\")]),_._v(\" \"),v(\"p\",[_._v(\"4-3. 未送信者リスト（引数：out_unsentListDataTable）に契約一覧情報を追加出力する\"),v(\"br\"),_._v(\"\\n　対象：上記2で出力したスタッフ情報（引数：out_staffDataTable）に\"),v(\"br\"),_._v(\"\\n　　　　契約一覧情報（引数：out_staNaviDataTable）のスタッフ番号と受注番号が一致する\"),v(\"br\"),_._v(\"\\n　　　　スタッフ情報が存在しない／複数件存在する、または、スタッフ情報のメールアドレスが空\"),v(\"br\"),_._v(\"\\n　  未送信者リストへの出力内容\"),v(\"br\"),_._v(\"\\n　　・実行日時 ← 処理日（引数：in_processDate）\"),v(\"br\"),_._v(\"\\n　　・受注番号 ← 契約一覧情報（引数：out_staNaviDataTable）の受注番号\"),v(\"br\"),_._v(\"\\n　　・クライアント番号 ← 契約一覧情報（引数：out_staNaviDataTable）のクライアント番号\"),v(\"br\"),_._v(\"\\n　　・就業先部署名 ← 契約一覧情報（引数：out_staNaviDataTable）の就業先部署名\"),v(\"br\"),_._v(\"\\n　　・スタッフ番号 ← 契約一覧情報（引数：out_staNaviDataTable）のスタッフ番号\"),v(\"br\"),_._v(\"\\n　　・スタッフ名 ← 契約一覧情報（引数：out_staNaviDataTable）のスタッフ番号\")]),_._v(\" \"),v(\"p\",[_._v(\"4-4. 初回就業日通知メールCSVファイルを作成する\"),v(\"br\"),_._v(\"\\n　対象：上記4-1、4-3の対象以外\"),v(\"br\"),_._v(\"\\n　テンプレート：初回就業日通知メールテンプレートファイルパス（引数：in_templateFile）\"),v(\"br\"),_._v(\"\\n　初回就業日通知メールCSVファイルの作成内容\"),v(\"br\"),_._v(\"\\n　　・send_to ← スタッフ情報（引数：out_staffDataTable）のメールアドレス を配置\"),v(\"br\"),_._v(\"\\n　　・body内の「＜スタッフー氏名＞」\"),v(\"br\"),_._v(\"\\n　　　　　　　← スタッフ情報（引数：out_staffDataTable）の氏名（漢字）を置換\"),v(\"br\"),_._v(\"\\n　　・body内の「YYYY/MM/DD」\"),v(\"br\"),_._v(\"\\n　　　　　　　← 契約一覧情報（引数：out_staNaviDataTable）の契約期間（引当）－開始日 を置換\"),v(\"br\"),_._v(\"\\n　　・body内の「＜契約期間（引当）－開始日＞」\"),v(\"br\"),_._v(\"\\n　　　　　　　← 契約一覧情報（引数：out_staNaviDataTable）の契約期間（引当）－開始日 を置換\"),v(\"br\"),_._v(\"\\n　　・body内の「＜ｸﾗｲｱﾝﾄ名＞」\"),v(\"br\"),_._v(\"\\n　　　　　　　← 契約一覧情報（引数：out_staNaviDataTable）のクライアント名 を置換\"),v(\"br\"),_._v(\"\\n　　・body内の「＜就業先部署名＞」\"),v(\"br\"),_._v(\"\\n　　　　　　　← 契約一覧情報（引数：out_staNaviDataTable）の就業先部署名 を置換\"),v(\"br\"),_._v(\"\\n　初回就業日通知メールCSVファイルのファイルパス\"),v(\"br\"),_._v('\\n　　：初回就業日通知メールCSVファイル格納先フォルダパス（引数：in_tmpSendFolder） ＋ \"\"'),v(\"br\"),_._v(\"\\n　　　プロジェクト設定情報（引数：in_dicAppSettings）の currentMailCSV ＋\"),v(\"br\"),_._v('\\n　　　契約一覧情報（引数：out_staNaviDataTable）の受注番号 ＋ \"'),v(\"em\",[_._v('\"'),v(\"br\"),_._v('\\n　　　契約一覧情報（引数：out_staNaviDataTable）のスタッフ番号 ＋ \"')]),_._v('\"'),v(\"br\"),_._v('\\n　　　処理日（引数：in_processDate）yyyyMMdd形式 ＋ \"_\"'),v(\"br\"),_._v('\\n　　　契約一覧情報（引数：out_staNaviDataTable）の連番 ＋ \".csv\"'),v(\"br\"),_._v(\"\\n　　例）C:\\\\diprpa\\\\HRRA_003a_初回就業日事前通知\\\\send\\\\Mail_98_20093_20200415_1.csv\")]),_._v(\" \"),v(\"p\",[_._v(\"4-5. 送信者リスト（引数：out_thisSentListDataTable）に契約一覧情報を追加出力する\"),v(\"br\"),_._v(\"\\n　対象：上記4-1、4-3の対象以外\"),v(\"br\"),_._v(\"\\n　送信者リストへの出力内容\"),v(\"br\"),_._v(\"\\n　　・実行日時 ← 処理日（引数：in_processDate）\"),v(\"br\"),_._v(\"\\n　　・受注番号 ← 契約一覧情報（引数：out_staNaviDataTable）の受注番号\"),v(\"br\"),_._v(\"\\n　　・スタッフ番号 ← 契約一覧情報（引数：out_staNaviDataTable）のスタッフ番号\")]),_._v(\" \"),v(\"p\",[_._v(\"4-6. CSV作成数（引数：out_createMailCsvNumber）を＋１カウントする\")])]),_._v(\" \"),v(\"li\",[v(\"p\",[_._v(\"処理結果フラグ（引数：out_isSuccess）に「True」を出力する\")])]),_._v(\" \"),v(\"li\",[v(\"p\",[_._v(\"例外（Exception）が発生した場合\"),v(\"br\"),_._v(\"\\n　出力エラー番号（引数：out_errorNumber）に入力エラー番号（引数：in_errorNumber）を出力する\")])])]),_._v(\" \"),v(\"br\")])}),[],!1,null,null,null);t.default=r.exports}}]);","extractedComments":[]}