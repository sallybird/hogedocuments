{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[352],{859:function(_,v,r){\"use strict\";r.r(v);var t=r(42),e=Object(t.a)({},(function(){var _=this,v=_.$createElement,r=_._self._c||v;return r(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":_.$parent.slotKey}},[r(\"h1\",{attrs:{id:\"hrra-001c-スタッフ出力-xaml\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#hrra-001c-スタッフ出力-xaml\"}},[_._v(\"#\")]),_._v(\" HRRA_001c_スタッフ出力.xaml\")]),_._v(\" \"),r(\"p\",[_._v(\"全体の処理フロー構成ファイル（ロボットが実行されるファイル）\")]),_._v(\" \"),r(\"h2\",{attrs:{id:\"引数\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#引数\"}},[_._v(\"#\")]),_._v(\" 引数\")]),_._v(\" \"),r(\"table\",[r(\"thead\",[r(\"tr\",[r(\"th\",[_._v(\"引数名\")]),_._v(\" \"),r(\"th\",[_._v(\"説明\")]),_._v(\" \"),r(\"th\",[_._v(\"方向\")]),_._v(\" \"),r(\"th\",[_._v(\"型\")]),_._v(\" \"),r(\"th\",[_._v(\"備考\")])])]),_._v(\" \"),r(\"tbody\",[r(\"tr\",[r(\"td\",[_._v(\"in_commonSettingsPath\")]),_._v(\" \"),r(\"td\",[_._v(\"共通設定のファイルパス \"),r(\"br\"),_._v(\"（即定値）c:\\\\diprpa\\\\共通\\\\HR_共通設定.xlsx\")]),_._v(\" \"),r(\"td\",[_._v(\"入力\")]),_._v(\" \"),r(\"td\",[_._v(\"String\")]),_._v(\" \"),r(\"td\",[_._v(\"－\")])]),_._v(\" \"),r(\"tr\",[r(\"td\",[_._v(\"in_projectName\")]),_._v(\" \"),r(\"td\",[_._v(\"プロジェクト名 \"),r(\"br\"),_._v(\"（即定値）HRRA_001c_スタッフ出力\")]),_._v(\" \"),r(\"td\",[_._v(\"入力\")]),_._v(\" \"),r(\"td\",[_._v(\"String\")]),_._v(\" \"),r(\"td\",[_._v(\"－\")])])])]),_._v(\" \"),r(\"br\"),_._v(\" \"),r(\"h2\",{attrs:{id:\"処理内容\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#処理内容\"}},[_._v(\"#\")]),_._v(\" 処理内容\")]),_._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[_._v(\"初期処理\"),r(\"br\"),_._v(\"\\n　1-1. プロジェクト名の設定\"),r(\"br\"),_._v(\"\\n　1-2. システム日付の設定\"),r(\"br\"),_._v(\"\\n　1-3. Excel全クローズ\"),r(\"br\"),_._v(\"\\n　1-4. 共通設定の読込\"),r(\"br\"),_._v(\"\\n　1-5. ルートパスの存在確認\"),r(\"br\"),_._v(\"\\n　1-6. プロジェクトフォルダ・ファイルのチェック\"),r(\"br\"),_._v(\"\\n　1-7. ユーザー設定の読み込み\"),r(\"br\"),_._v(\"\\n　1-8. プロジェクト設定の読込\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"必須情報の有無\"),r(\"br\"),_._v(\"\\n　2-1. 共通設定の項目確認\"),r(\"br\"),_._v(\"\\n　2-2. プロジェクト設定の項目確認\"),r(\"br\"),_._v(\"\\n　2-3. ユーザー設定の項目確認\"),r(\"br\"),_._v(\"\\n　2-4. Capture,tmpフォルダの存在確認・作成\"),r(\"br\"),_._v(\"\\n　2-5. 必須フォルダ、ファイルの確認\")])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"過去ファイル削除\"),r(\"br\"),_._v(\"\\n　3-1. tmpフォルダ内のファイル削除\"),r(\"br\"),_._v(\"\\n　3-2. Exception発生時、処理結果フラグ、エラーメッセージをセットする\\n　　\"),r(\"em\",[_._v(\"isSuccess = False\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"errorMessage = 【tmpフォルダ内ファイル削除】上記のファイル削除にエラーが発生しました。\")])])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"契約開始対象スタッフ取得\"),r(\"br\"),_._v(\"\\n　4-1. ユーザー入力のブロック\"),r(\"br\"),_._v(\"\\n　4-2. 対象スタッフの取得\"),r(\"br\"),_._v(\"\\n　　→ 対象スタッフ取得処理呼び出し(\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_応募対応/スタッフ登録/詳細機能設計/HRRA_001c_スタッフ出力/xaml/Staff2000CSVExport.xaml.html\"}},[_._v(\"Staff2000CSVExport.xaml\")]),_._v(\")\"),r(\"br\"),_._v(\"\\n　　　引数\"),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_dicCommonSettings = 共通設定ファイルの内容\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_dicUserSettings = ユーザー設定ファイルの内容\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v('in_targetDate = \"\"')]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"out_isSuccess = 処理結果フラグ\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_pathDownloadCsvFile = 基幹システムからエクスポートしたファイルのパス\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_pathSKM = SKMファイルのパス\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"out_errorMessage = エラーメッセージ\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_projectName = 実行しているプロジェクト名\")]),r(\"br\"),_._v(\"\\n　　4-2-1. Staff2000のログイン\"),r(\"br\"),_._v(\"\\n　　　→ Staff2000のログイン処理呼び出し(\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_応募対応/スタッフ登録/詳細機能設計/HRRA_001c_スタッフ出力/xaml/Staff2000Login.xaml.html\"}},[_._v(\"Staff2000Login.xaml\")]),_._v(\")\"),r(\"br\"),_._v(\"\\n　　　　引数\"),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"out_result = 処理結果フラグ\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_dicUserSettings = ユーザー設定ファイルの内容\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_dicCommonSettings = 共通設定ファイルの内容\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"out_errorMessage = エラーメッセージ\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_projectName = 実行しているプロジェクト名\")]),r(\"br\"),_._v(\"\\n　　4-2-2. 絞り込み条件の解除\"),r(\"br\"),_._v(\"\\n　　　→ 絞り込み条件の解除処理呼び出し(\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_応募対応/スタッフ登録/詳細機能設計/HRRA_001c_スタッフ出力/xaml/Staff2000Unfilter.xaml.html\"}},[_._v(\"Staff2000Unfilter.xaml\")]),_._v(\")\"),r(\"br\"),_._v(\"\\n　　　　引数\"),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"out_isSuccess = 処理結果フラグ\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"out_errorMessage = エラーメッセージ\")]),r(\"br\"),_._v(\"\\n　　4-2-3. 対象スタッフの出力\"),r(\"br\"),_._v(\"\\n　4-3. ノリスケ送信用ファイル作成\"),r(\"br\"),_._v(\"\\n　　→ ノリスケ送信用CSVファイル作成処理呼び出し(\"),r(\"RouterLink\",{attrs:{to:\"/HR/設計書/HRRA_応募対応/スタッフ登録/詳細機能設計/HRRA_001c_スタッフ出力/xaml/ResultCsvCreate.xaml.html\"}},[_._v(\"ResultCsvCreate.xaml\")]),_._v(\")\"),r(\"br\"),_._v(\"\\n　　　引数\"),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_downloadCsvFilePath = 基幹システムからエクスポートしたファイルのパス\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_setStaffListNorisukePath = ノリスケに送付するスタッフ情報ファイルのパス\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_apiSetStaffTemplatePath = ノリスケ項目を管理するテンプレートファイルのパス\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_staffListPath = 共通のスタッフ情報ファイルのパス\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"out_isSuccess = 処理結果フラグ\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"out_errorMessage = エラーメッセージ\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"in_dicUserSettings = ユーザー設定ファイルの内容\")])],1)]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"スタッフ情報送信\"),r(\"br\"),_._v(\"\\n　5-1. ユーザー設定ファイルからAPIのエンドポイントを取得\"),r(\"br\"),_._v('\\n　　→ dicUserSettings(\"ApiEndPoint\").toString'),r(\"br\"),_._v(\"\\n　5-2. API接続\"),r(\"br\"),_._v(\"\\n　　・ヘッダ\"),r(\"br\"),_._v('\\n　　　→ Authorization = \"Bearer \"+dicUserSettings(\"ApiSetSecretToken\").toString'),r(\"br\"),_._v(\"\\n　　・ボディフォーマット = application/xml\"),r(\"br\"),_._v(\"\\n　　・添付\\n　　　→ file = ノリスケ送付用スタッフ情報ファイルパス\"),r(\"br\"),_._v('\\n　　・タイムアウト = CInt(dicUserSettings(\"ApiSetStaffListDelay\")) * 1000'),r(\"br\"),_._v(\"\\n　　・メソッド = POST\"),r(\"br\"),_._v(\"\\n　5-3. Exception発生時、処理結果フラグ、エラーメッセージをセットする\"),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"isSuccess = False\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"errorMessage = exception.Message\")]),r(\"br\"),_._v(\"\\n　5-4. APIのレスポンス処理\"),r(\"br\"),_._v(\"\\n　　レスポンスコードにより処理を分ける\"),r(\"br\"),_._v(\"\\n　　・401の場合\"),r(\"br\"),_._v(\"\\n　　　エラー処理\"),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"処理結果フラグ = False\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"エラーメッセージ = ステータスコード:401, 内容：ノリスケにファイルを受付する時、認証エラーが発生しました\")]),r(\"br\"),_._v(\"\\n　　・413の場合\"),r(\"br\"),_._v(\"\\n　　　エラー処理\"),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"処理結果フラグ = False\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"エラーメッセージ = ステータスコード:413, 内容：ノリスケにファイルを受付する時、リクエストファイルサイズ超過エラーが発生しました\")]),r(\"br\"),_._v(\"\\n　　・400の場合\"),r(\"br\"),_._v(\"\\n　　　エラー処理\"),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"処理結果フラグ = False\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"エラーメッセージ = ステータスコード:400, 内容：ノリスケにファイルを受付する時、ファイル受付エラーが発生しました\")]),r(\"br\"),_._v(\"\\n　　・200の場合\"),r(\"br\"),_._v(\"\\n　　　正常処理\"),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"処理結果フラグ = True\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"メッセージ = ステータスコード:200, 内容：ノリスケにファイル受付成功です\")]),r(\"br\"),_._v(\"\\n　　・上記意外の場合\"),r(\"br\"),_._v(\"\\n　　　エラー処理\"),r(\"br\"),_._v(\" \"),r(\"em\",[_._v(\"処理結果フラグ = False\")]),r(\"br\"),_._v(\" \"),r(\"em\",[_._v('エラーメッセージ = ステータスコード: \" + If( isNothing(responseCode),\"\",responseCode.ToString) + \" , 内容：ノリスケにファイルを受付する時、異常のエラーが発生しました')])])]),_._v(\" \"),r(\"li\",[r(\"p\",[_._v(\"終端処理\")])])])])}),[],!1,null,null,null);v.default=e.exports}}]);","extractedComments":[]}